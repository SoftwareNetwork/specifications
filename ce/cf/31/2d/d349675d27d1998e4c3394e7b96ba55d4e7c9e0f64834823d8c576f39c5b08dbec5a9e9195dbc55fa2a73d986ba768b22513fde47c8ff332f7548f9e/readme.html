<div align="center">
<img width="200" src="https://avatars0.githubusercontent.com/u/49841676?s=200&v=4">
</div>
<h1 id="jinja2ั">Jinja2ะก++</h1>
<p><a href="https://isocpp.org/"><img src="https://img.shields.io/badge/language-C++-blue.svg" alt="Language" /></a> <a href="https://en.wikipedia.org/wiki/C%2B%2B#Standardization"><img src="https://img.shields.io/badge/c%2B%2B-14-blue.svg" alt="Standard" /></a> <a href="https://travis-ci.org/jinja2cpp/Jinja2Cpp"><img src="https://travis-ci.org/jinja2cpp/Jinja2Cpp.svg?branch=master" alt="Build Status" /></a> <a href="https://ci.appveyor.com/project/flexferrum/jinja2cpp-n5hjm/branch/master"><img src="https://ci.appveyor.com/api/projects/status/vu59lw4r67n8jdxl/branch/master?svg=true" alt="Build status" /></a> <a href="https://codecov.io/gh/jinja2cpp/Jinja2Cpp"><img src="https://codecov.io/gh/jinja2cpp/Jinja2Cpp/branch/master/graph/badge.svg" alt="Coverage Status" /></a> <a href="https://www.codacy.com/app/flexferrum/Jinja2Cpp_2?utm_source=github.com&amp;utm_medium=referral&amp;utm_content=jinja2cpp/Jinja2Cpp&amp;utm_campaign=Badge_Grade"><img src="https://api.codacy.com/project/badge/Grade/ff01fa4410ac417f8192dce78e919ece" alt="Codacy Badge" /></a> <a href="https://github.com/jinja2cpp/Jinja2Cpp/releases"><img src="https://img.shields.io/github/release/jinja2cpp/Jinja2Cpp/all.svg" alt="Github Releases" /></a> <a href="http://github.com/jinja2cpp/Jinja2Cpp/issues"><img src="https://img.shields.io/github/issues/jinja2cpp/Jinja2Cpp.svg" alt="Github Issues" /></a> <a href="https://raw.githubusercontent.com/jinja2cpp/Jinja2Cpp/master/LICENSE"><img src="https://img.shields.io/badge/license-Mozilla-blue.svg" alt="GitHub License" /></a> <a href="https://bintray.com/flexferrum/conan-packages/jinja2cpp:flexferrum/1.0.0:testing/link"><img src="https://api.bintray.com/packages/flexferrum/conan-packages/jinja2cpp:flexferrum/images/download.svg?version=1.0.0:testing" alt="conan.io" /></a> <a href="https://gitter.im/Jinja2Cpp/Lobby"><img src="https://badges.gitter.im/Join%20Chat.svg" alt="Gitter Chat" /></a></p>
<p>C++ implementation of Jinja2 Python template engine. This library brings support of powerful Jinja2 templates features into the C++ world. Reports and dynamic html pages, source code generation and</p>
<h2 id="introduction">Introduction</h2>
<p>Main features of Jinja2C++: - Easy-to-use public interface. Just load templates and render them. - Conformance to <a href="http://jinja.pocoo.org/docs/2.10/">Jinja2 specification</a> - Full support of narrow- and wide-character strings both for templates and parameters. - Built-in reflection for the common C++ types, nlohmann and rapid JSON libraries. - Powerful full-featured Jinja2 expressions with filtering (via '|' operator) and 'if'-expressions. - Control statements (<code>set</code>, <code>for</code>, <code>if</code>, <code>filter</code>, <code>do</code>, <code>with</code>). - Templates extention, including and importing - Macros - Rich error reporting. - Shared template enironment with templates cache support</p>
<p>For instance, this simple code:</p>
<div class="sourceCode"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span class="pp">#include </span><span class="im">&lt;jinja2cpp/template.h&gt;</span>

<span class="bu">std::</span>string source = <span class="st">R&quot;(</span>
<span class="st">{{ (&quot;Hello&quot;, &#39;world&#39;) | join }}!!!</span>
<span class="st">{{ (&quot;Hello&quot;, &#39;world&#39;) | join(&#39;, &#39;) }}!!!</span>
<span class="st">{{ (&quot;Hello&quot;, &#39;world&#39;) | join(d = &#39;; &#39;) }}!!!</span>
<span class="st">{{ (&quot;Hello&quot;, &#39;world&#39;) | join(d = &#39;; &#39;) | lower }}!!!</span>
<span class="st">)&quot;</span>;

Template tpl;
tpl.Load(source);

<span class="bu">std::</span>string result = tpl.RenderAsString({}).value();</code></pre></div>
<p>produces the result string:</p>
<pre><code>Helloworld!!!
Hello, world!!!
Hello; world!!!
hello; world!!!</code></pre>
<h2 id="getting-started">Getting started</h2>
<p>In order to use Jinja2C++ in your project you have to: * Clone the Jinja2C++ repository * Build it according with the <a href="https://jinja2cpp.dev/docs/build_and_install.html">instructions</a> * Link to your project.</p>
<p>Usage of Jinja2C++ in the code is pretty simple: 1. Declare the jinja2::Template object:</p>
<div class="sourceCode"><pre class="sourceCode cpp"><code class="sourceCode cpp">jinja2::Template tpl;</code></pre></div>
<ol start="2" style="list-style-type: decimal">
<li>Populate it with template:</li>
</ol>
<div class="sourceCode"><pre class="sourceCode cpp"><code class="sourceCode cpp">tpl.Load(<span class="st">&quot;{{ &#39;Hello World&#39; }}!!!&quot;</span>);</code></pre></div>
<ol start="3" style="list-style-type: decimal">
<li>Render the template:</li>
</ol>
<div class="sourceCode"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span class="bu">std::</span>cout &lt;&lt; tpl.RenderAsString({}).value() &lt;&lt; <span class="bu">std::</span>endl;</code></pre></div>
<p>and get:</p>
<p><code>Hello World!!!</code></p>
<p>That's all!</p>
<p>More detailed examples and features describtion can be found in the documentation: <a href="https://jinja2cpp.dev/docs/usage" class="uri">https://jinja2cpp.dev/docs/usage</a></p>
<h2 id="current-jinja2-support">Current Jinja2 support</h2>
<p>Currently, Jinja2C++ supports the limited number of Jinja2 features. By the way, Jinja2C++ is planned to be full <a href="http://jinja.pocoo.org/docs/2.10/templates/">jinja2 specification</a>-conformant. The current support is limited to: - expressions. You can use almost every style of expressions: simple, filtered, conditional, and so on. - big number of filters (<strong>sort, default, first, last, length, max, min, reverse, unique, sum, attr, map, reject, rejectattr, select, selectattr, pprint, dictsort, abs, float, int, list, round, random, trim, title, upper, wordcount, replace, truncate, groupby, urlencode, capitalize, escape</strong>) - big number of testers (<strong>eq, defined, ge, gt, iterable, le, lt, mapping, ne, number, sequence, string, undefined, in, even, odd, lower, upper</strong>) - limited number of functions (<strong>range</strong>, <strong>loop.cycle</strong>) - 'if' statement (with 'elif' and 'else' branches) - 'for' statement (with 'else' branch and 'if' part support) - 'include' statement - 'import'/'from' statements - 'set' statement (both line and block) - 'filter' statement - 'extends'/'block' statements - 'macro'/'call' statements - 'with' statement - 'do' extension statement - recursive loops - space control</p>
<p>Full information about Jinja2 specification support and compatibility table can be found here: <a href="https://jinja2cpp.dev/docs/j2_compatibility.html" class="uri">https://jinja2cpp.dev/docs/j2_compatibility.html</a>.</p>
<h2 id="supported-compilers">Supported compilers</h2>
<p>Compilation of Jinja2C++ tested on the following compilers (with C++14 and C++17 enabled features): - Linux gcc 5.5 - 9.0 - Linux clang 5.0 - 9 - MacOS X-Code 9 - MacOS X-Code 10 - MacOS X-Code 11 (C++14 in default build, C++17 with externally-provided boost) - Microsoft Visual Studio 2015 - 2019 x86, x64 - MinGW gcc compiler 7.3 - MinGW gcc compiler 8.1</p>
<p><strong>Note:</strong> Support of gcc version &gt;= 9.x or clang version &gt;= 8.0 depends on version of Boost library provided.</p>
<h2 id="build-and-install">Build and install</h2>
<p>Jinja2C++ has several external dependencies: - <code>boost</code> library (at least version 1.65) - <code>nonstd::expected-lite</code> <a href="https://github.com/martinmoene/expected-lite" class="uri">https://github.com/martinmoene/expected-lite</a> - <code>nonstd::variant-lite</code> <a href="https://github.com/martinmoene/variant-lite" class="uri">https://github.com/martinmoene/variant-lite</a> - <code>nonstd::value-ptr-lite</code> <a href="https://github.com/martinmoene/value-ptr-lite" class="uri">https://github.com/martinmoene/value-ptr-lite</a> - <code>nonstd::optional-lite</code> <a href="https://github.com/martinmoene/optional-lite" class="uri">https://github.com/martinmoene/optional-lite</a> - <code>nonstd::string-view-lite</code> <a href="https://github.com/martinmoene/string-view-lite" class="uri">https://github.com/martinmoene/string-view-lite</a> - <code>fmtlib::fmt</code> <a href="https://github.com/fmtlib/fmt" class="uri">https://github.com/fmtlib/fmt</a> - <code>robin-hood-hashing</code> <a href="https://github.com/martinus/robin-hood-hashing" class="uri">https://github.com/martinus/robin-hood-hashing</a></p>
<p>In simpliest case to compile Jinja2C++ you need:</p>
<ol style="list-style-type: decimal">
<li>Install CMake build system (at least version 3.0)</li>
<li>Clone jinja2cpp repository and update submodules:</li>
</ol>
<pre><code>&gt; git clone https://github.com/flexferrum/Jinja2Cpp.git
&gt; git submodule -q update --init</code></pre>
<ol start="3" style="list-style-type: decimal">
<li>Create build directory:</li>
</ol>
<pre><code>&gt; cd Jinja2Cpp
&gt; mkdir build</code></pre>
<ol start="4" style="list-style-type: decimal">
<li>Run CMake and build the library:</li>
</ol>
<pre><code>&gt; cd build
&gt; cmake .. -DCMAKE_INSTALL_PREFIX=&lt;path to install folder&gt;
&gt; cmake --build . --target all</code></pre>
<p>&quot;Path to install folder&quot; here is a path to the folder where you want to install Jinja2C++ lib.</p>
<ol start="5" style="list-style-type: decimal">
<li>Install library:</li>
</ol>
<pre><code>&gt; cmake --build . --target install</code></pre>
<p>In this case Jinja2C++ will be built with internally-shipped dependencies and install them respectively. But Jinja2C++ supports build with externally-provided deps. Different Jinja2C++ usage scenarios can be found in this repository: https://github.com/jinja2cpp/examples-build</p>
<h3 id="usage-with-conan.io-dependency-manager">Usage with conan.io dependency manager</h3>
<p>Jinja2C++ can be used as conan.io package. In this case you should do the following steps:</p>
<ol style="list-style-type: decimal">
<li>Install conan.io according to the documentation ( https://docs.conan.io/en/latest/installation.html )</li>
<li>Register the following remote conan.io repositories:
<ul>
<li>https://api.bintray.com/conan/martinmoene/nonstd-lite</li>
<li>https://api.bintray.com/conan/bincrafters/public-conan</li>
<li>https://api.bintray.com/conan/flexferrum/conan-packages</li>
</ul></li>
</ol>
<p>The sample command is: <code>conan remote add martin https://api.bintray.com/conan/martinmoene/nonstd-lite</code></p>
<ol start="3" style="list-style-type: decimal">
<li>Add reference to Jinja2C++ package (<code>jinja2cpp/1.0.0@flexferrum/testing</code>) to your conanfile.txt, conanfile.py or CMakeLists.txt. For instance, with usage of <code>conan-cmake</code> integration it could be written this way:</li>
</ol>
<div class="sourceCode"><pre class="sourceCode cmake"><code class="sourceCode cmake"><span class="kw">include</span> (../../cmake/conan.cmake)
<span class="kw">if</span> (<span class="ot">NOT</span> <span class="va">MSVC</span>)
    <span class="kw">set</span> (CONAN_SETTINGS SETTINGS compiler.libcxx=libstdc++11)
<span class="kw">endif</span> ()

<span class="fu">conan_cmake_run</span>(REQUIRES 
                    jinja2cpp/1.0.0@flexferrum/testing
                    gtest/1.7.0@bincrafters/stable
                BASIC_SETUP
                <span class="va">${CONAN_SETTINGS}</span>
                OPTIONS 
                    jinja2cpp:shared=False
                    gtest:shared=False
                BUILD missing)
                
<span class="kw">set</span> (TARGET_NAME jinja2cpp_build_test)

<span class="kw">add_executable</span> (<span class="va">${TARGET_NAME}</span> main.cpp)

<span class="kw">target_link_libraries</span> (<span class="va">${TARGET_NAME}</span> <span class="va">${CONAN_LIBS}</span>)
<span class="kw">set_target_properties</span> (<span class="va">${TARGET_NAME}</span> <span class="ot">PROPERTIES</span>
            <span class="ot">CXX_STANDARD</span> 14
            <span class="ot">CXX_STANDARD_REQUIRED</span> <span class="ot">ON</span>)</code></pre></div>
<h3 id="additional-cmake-build-flags">Additional CMake build flags</h3>
<p>You can define (via -D command line CMake option) the following build flags:</p>
<ul>
<li><strong>JINJA2CPP_BUILD_TESTS</strong> (default TRUE) - to build or not to Jinja2C++ tests.</li>
<li><strong>JINJA2CPP_STRICT_WARNINGS</strong> (default TRUE) - Enable strict mode compile-warnings(-Wall -Werror and etc).</li>
<li><strong>JINJA2CPP_BUILD_SHARED</strong> (default OFF) - Specify Jinja2C++ library library link type.</li>
<li><strong>JINJA2CPP_MSVC_RUNTIME_TYPE</strong> (default /MD) - MSVC runtime type to link with (if you use Microsoft Visual Studio compiler).</li>
<li><strong>JINJA2CPP_DEPS_MODE</strong> (default &quot;internal&quot;) - modes for dependencies handling. Following values possible:
<ul>
<li><code>internal</code> In this mode Jinja2C++ build script uses dependencies (include <code>boost</code>) shipped as subprojects. Nothing needs to be provided externally.</li>
<li><code>external-boost</code> In this mode Jinja2C++ build script uses only <code>boost</code> as externally-provided dependency. All other dependencies taken from subprojects.</li>
<li><code>external</code> In this mode all dependencies should be provided externally. Paths to <code>boost</code>, <code>nonstd-*</code> libs etc. should be specified via standard CMake variables (like <code>CMAKE_PREFIX_PATH</code> or libname_DIR)</li>
<li><code>conan-build</code> Special mode for building Jinja2C++ via conan recipe.</li>
</ul></li>
</ul>
<h3 id="build-with-c17-standard-enabled">Build with C++17 standard enabled</h3>
<p>In case of C++17 standard enabled for your project you should define <code>variant_CONFIG_SELECT_VARIANT=variant_VARIANT_NONSTD nssv_CONFIG_SELECT_STRING_VIEW=nssv_STRING_VIEW_NONSTD optional_CONFIG_SELECT_OPTIONAL=optional_OPTIONAL_NONSTD</code> macros in the build settings.</p>
<h2 id="acknowledgments">Acknowledgments</h2>
<p>Thanks to <strong><span class="citation">@manu343726</span></strong> for CMake scripts improvement, bugs hunting and fixing and conan.io packaging.</p>
<p>Thanks to <strong><span class="citation">@martinmoene</span></strong> for the perfectly implemented xxx-lite libraries.</p>
<p>Thanks to <strong><span class="citation">@vitaut</span></strong> for the amazing text formatting library</p>
<p>Thanks to <strong><span class="citation">@martinus</span></strong> for the fast hash maps implementation</p>
<p>Thanks to <strong><span class="citation">@palchukovsky</span></strong> for the great contribution into codebase</p>
<p>Thanks to <strong><span class="citation">@rmorozov</span></strong> for stanitized builds setup</p>
<h2 id="changelog">Changelog</h2>
<h3 id="version-1.0.0">Version 1.0.0</h3>
<h4 id="changes-and-improvements">Changes and improvements</h4>
<ul>
<li><code>default</code> attribute added to the <code>map</code> filter (#48)</li>
<li>escape sequences support added to the string literals (#49)</li>
<li>arbitrary ranges, generated sequences, input iterators etc. now can be used with <code>GenericList</code> type (#66)</li>
<li>nonstd::string_view is now one of the possible types for the <code>Value</code></li>
<li><code>filter</code> tag support added to the template parser (#44)</li>
<li><code>escape</code> filter support added to the template parser (#140)</li>
<li><code>capitalize</code> filter support added to the template parser (#137)</li>
<li>multiline version of <code>set</code> tag added to the parser (#45)</li>
<li>added built-in reflection for nlohmann json and rapid json libraries (#78)</li>
<li><code>loop.depth</code> and <code>loop.depth0</code> variables support added</li>
<li>{fmt} is now used as a formatting library instead of iostreams</li>
<li>robin hood hash maps is now used for internal value storage</li>
<li>rendering performance improvements</li>
<li>template cache implemented in <code>TemplateEnv</code></li>
<li>ability to define global variables in <code>TemplateEnv</code> added</li>
<li>user-defined callables now can accept global context via <code>*context</code> special param</li>
<li>MinGW, clang &gt;= 7.0, XCode &gt;= 9, gcc &gt;= 7.0 are now officially supported as a target compilers (#79)</li>
</ul>
<h4 id="fixed-bugs">Fixed bugs</h4>
<ul>
<li>Fixed pipe (<code>|</code>) operator precedence (#47)</li>
<li>Fixed bug in internal char &lt;-&gt; wchar_t converter on Windows</li>
<li>Fixed crash in parsing <code>endblock</code> tag</li>
<li>Fixed scope control for <code>include</code> and <code>for</code> tags</li>
<li>Fixed bug with macros call within expression context</li>
</ul>
<h4 id="breaking-changes">Breaking changes</h4>
<ul>
<li>MSVC runtime type is now defines by <code>JINJA2CPP_MSVC_RUNTIME_TYPE</code> CMake variable</li>
</ul>
<h3 id="version-0.9.2">Version 0.9.2</h3>
<h4 id="major-changes">Major changes</h4>
<ul>
<li>User-defined callables implemented. Now you can define your own callable objects, pass them as input parameters and use them inside templates as regular (global) functions, filters or testers. See details here: https://jinja2cpp.dev/docs/usage/ud_callables.html</li>
<li>Now you can define global (template environment-wide) parameters which are accessible for all templates bound to this environment.</li>
<li><code>include</code>, <code>import</code> and <code>from</code> statements implemented. Now it's possible to include other templates and use macros from other templates.</li>
<li><code>with</code> statement implemented</li>
<li><code>do</code> statement implemented</li>
<li>Sample build projects for various Jinja2C++ usage variants created: https://github.com/jinja2cpp/examples-build</li>
<li>Documentation site created for Jinja2C++: https://jinja2cpp.dev/</li>
</ul>
<h4 id="minor-changes">Minor changes</h4>
<ul>
<li>Render-time error handling added</li>
<li>Dependency management mode added to the build script</li>
<li>Fix bugs with error reporting during the parse time</li>
<li>Upgraded versions of external dependencies</li>
</ul>
<h4 id="breaking-changes-1">Breaking changes</h4>
<ul>
<li><code>RenderAsString</code> method now returns <code>nonstd::expected</code> instead of regular <code>std::string</code></li>
<li>Templates with <code>import</code>, <code>extends</code> and <code>include</code> generate errors if parsed without <code>TemplateEnv</code> set</li>
<li>Release bundles (archives) are configured with <code>external</code> dependency management mode by default</li>
</ul>
<h3 id="version-0.9.1">Version 0.9.1</h3>
<ul>
<li><code>applymacro</code> filter added which allows to apply arbitrary macro as a filter</li>
<li>dependencies to boost removed from the public interface</li>
<li>CMake scripts improved</li>
<li>Various bugs fixed</li>
<li>Improve reflection</li>
<li>Warnings cleanup</li>
</ul>
<h3 id="version-0.9">Version 0.9</h3>
<ul>
<li>Support of 'extents'/'block' statements</li>
<li>Support of 'macro'/'call' statements</li>
<li>Rich error reporting</li>
<li>Support for recursive loops</li>
<li>Support for space control before and after control blocks</li>
<li>Improve reflection</li>
</ul>
<h3 id="version-0.6">Version 0.6</h3>
<ul>
<li>A lot of filters has been implemented. Full set of supported filters listed here: <a href="https://github.com/flexferrum/Jinja2Cpp/issues/7" class="uri">https://github.com/flexferrum/Jinja2Cpp/issues/7</a></li>
<li>A lot of testers has been implemented. Full set of supported testers listed here: <a href="https://github.com/flexferrum/Jinja2Cpp/issues/8" class="uri">https://github.com/flexferrum/Jinja2Cpp/issues/8</a></li>
<li>'Contatenate as string' operator ('~') has been implemented</li>
<li>For-loop with 'if' condition has been implemented</li>
<li>Fixed some bugs in parser</li>
</ul>
