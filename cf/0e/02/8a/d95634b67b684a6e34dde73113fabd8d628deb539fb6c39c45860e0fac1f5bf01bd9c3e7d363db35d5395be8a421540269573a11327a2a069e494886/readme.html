<h1 id="scnlib">scnlib</h1>
<p><a href="https://travis-ci.com/eliaskosunen/scnlib"><img src="https://travis-ci.com/eliaskosunen/scnlib.svg?branch=master" alt="Travis CI Build Status" /></a> <a href="https://ci.appveyor.com/project/eliaskosunen/scnlib/branch/master"><img src="https://ci.appveyor.com/api/projects/status/ex0q59kt5h8yciqa/branch/master?svg=true" alt="Appveyor CI Build Status" /></a> <a href="https://codecov.io/gh/eliaskosunen/scnlib"><img src="https://codecov.io/gh/eliaskosunen/scnlib/branch/master/graph/badge.svg" alt="Codecov Coverage" /></a> <a href="https://www.codacy.com/app/eliaskosunen/scnlib?utm_source=github.com&amp;utm_medium=referral&amp;utm_content=eliaskosunen/scnlib&amp;utm_campaign=Badge_Grade"><img src="https://api.codacy.com/project/badge/Grade/daf649bfab44407fa7afda6cb97add2a" alt="Codacy Code Quality" /></a> <a href="https://github.com/eliaskosunen/scnlib/blob/master/LICENSE"><img src="https://img.shields.io/github/license/eliaskosunen/scnlib.svg" alt="License" /></a> <a href="https://img.shields.io/badge/C%2B%2B-11%2F14%2F17%2F20-blue.svg"><img src="https://img.shields.io/badge/C%2B%2B-11%2F14%2F17%2F20-blue.svg" alt="C++ Standard" /></a></p>
<div class="sourceCode"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span class="pp">#include </span><span class="im">&lt;scn/scn.h&gt;</span>
<span class="pp">#include </span><span class="im">&lt;cstdio&gt;</span>

<span class="dt">int</span> main() {
    <span class="dt">int</span> i;
    scn::prompt(<span class="st">&quot;What&#39;s your favorite number?&quot;</span>, <span class="st">&quot;{}&quot;</span>, i);
    printf(<span class="st">&quot;Oh, cool, </span><span class="sc">%d</span><span class="st">!&quot;</span>, i);
}

<span class="co">// Example result:</span>
<span class="co">// What&#39;s your favorite number? 42</span>
<span class="co">// Oh, cool, 42!</span></code></pre></div>
<h2 id="what-is-this">What is this?</h2>
<p><code>scnlib</code> is a modern C++ library for replacing <code>scanf</code> and <code>std::istream</code>. This library attempts to move us ever so closer to replacing <code>iostream</code>s and C stdio altogether. It's (going to, eventually, be) faster than <code>iostream</code> (see Benchmarks) and type-safe, unlike <code>scanf</code>. Think <a href="https://github.com/fmtlib/fmt">{fmt}</a> but in the other direction.</p>
<p>The library is still in early development (0.1), so don't expect perfection. See <a href="#stability">Stability</a> for more details.</p>
<p>This library is <em>not</em> an implementation of the ISO C++ standards proposal <a href="https://wg21.link/p1729">P1729 &quot;Text Parsing&quot;</a>, but it's developed completely independently.</p>
<h2 id="documentation-and-tutorial">Documentation and tutorial</h2>
<p>The documentation can be found online, from https://scnlib.dev. The documentation includes a tutorial.</p>
<p>To build the docs yourself, build the <code>doc</code> target generated by CMake. Building the documentation requires Doxygen.</p>
<p>Rather lacking examples can be found from the <code>examples/</code> folder.</p>
<p>Should you get stuck somewhere, you can find me on the <a href="https://cpplang.now.sh">CppLang Slack</a>, or by DMing me on <a href="https://twitter.com/eliaskosunen">Twitter</a>.</p>
<h2 id="installing">Installing</h2>
<h3 id="submodule">Submodule</h3>
<p>The easiest way of integrating <code>scnlib</code> to your project would likely be to use a <code>git submodule</code>.</p>
<div class="sourceCode"><pre class="sourceCode sh"><code class="sourceCode bash"><span class="co"># Replace `external/scnlib` with the directory where you&#39;d like the submodule be located</span>
$ <span class="fu">git</span> submodule add external/scnlib https://github.com/eliaskosunen/scnlib</code></pre></div>
<p>Then just do the following in your CMakeLists.txt</p>
<div class="sourceCode"><pre class="sourceCode cmake"><code class="sourceCode cmake"><span class="co"># Include the submodule directory</span>
<span class="kw">add_subdirectory</span>(external/scnlib <span class="ot">EXCLUDE_FROM_ALL</span>)

<span class="co"># Target which you&#39;d like to use scnlib</span>
<span class="kw">add_executable</span>(my_program ...)
<span class="co"># Use scn::scn-header-only if you&#39;d prefer</span>
<span class="kw">target_link_libraries</span>(my_program scn::scn)</code></pre></div>
<h3 id="external-project">External project</h3>
<p>You can also build <code>scnlib</code> separately.</p>
<div class="sourceCode"><pre class="sourceCode sh"><code class="sourceCode bash"><span class="co"># Whereever you cloned scnlib to</span>
$ <span class="fu">mkdir</span> build
$ <span class="bu">cd</span> build
$ <span class="fu">cmake</span> ..
$ <span class="fu">make</span> -j
$ <span class="fu">make</span> install</code></pre></div>
<p>Then, in your project:</p>
<div class="sourceCode"><pre class="sourceCode cmake"><code class="sourceCode cmake"><span class="co"># Find scnlib package</span>
<span class="kw">find_package</span>(scn <span class="ot">CONFIG</span> <span class="ot">REQUIRED</span>)

<span class="co"># Target which you&#39;d like to use scnlib</span>
<span class="kw">add_executable</span>(my_program ...)
<span class="kw">target_link_libraries</span>(my_program scn::scn)</code></pre></div>
<h2 id="compiler-support">Compiler support</h2>
<p>Every commit is tested with * gcc 5.5 and newer * clang 3.6 and newer * Visual Studio 2015 and 2017 with very extreme warning flags (see CMakeLists.txt) and with multiple build configurations for each compiler.</p>
<p>Older compilers may work, but it is not guaranteed. GCC 4.x support will not be provided, as its C++11 support is too buggy.</p>
<h2 id="stability">Stability</h2>
<p>The master-branch will be API-stable until the next minor release, 0.2. It will receive API-compatible bugfixes, should any be necessary, tagged appropriately (0.1.1 etc).</p>
<p>The dev-branch will not be stable. It may be rebased, and will contain changes that may break your code. Please don't depend on it, unless you really want to live on the edge.</p>
<p>No ABI stability is guaranteed at this point, and none will be pre-1.0.</p>
<p>This is still a pre-1.0 library, so there's bound to be bugs. If you find one, <em>please</em> report it.</p>
<h2 id="benchmarks">Benchmarks</h2>
<h3 id="run-time-performance">Run-time performance</h3>
<p>These benchmarks were run on a Ubuntu 19.04 machine running kernel version 5.0.0-15, with an Intel Core i7-8750H processor, and compiled with gcc version 8.3.0, with <code>-O3 -march=native</code>. The source code for the benchmarks can be seen in the <code>benchmark</code> directory.</p>
<p>Times are in nanoseconds of CPU time. Lower is better.</p>
<h4 id="reading-random-integers">Reading random integers</h4>
<table>
<thead>
<tr class="header">
<th align="left">Integer type</th>
<th><code>scn::scan</code></th>
<th align="right"><code>scn::get_value</code></th>
<th align="right"><code>std::stringstream</code></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><code>int</code></td>
<td>71</td>
<td align="right">50</td>
<td align="right">70</td>
</tr>
<tr class="even">
<td align="left"><code>long long</code></td>
<td>106</td>
<td align="right">81</td>
<td align="right">95</td>
</tr>
<tr class="odd">
<td align="left"><code>unsigned</code></td>
<td>81</td>
<td align="right">60</td>
<td align="right">53</td>
</tr>
</tbody>
</table>
<h4 id="reading-random-floating-point-numbers">Reading random floating-point numbers</h4>
<table>
<thead>
<tr class="header">
<th align="left">Floating-point type</th>
<th align="right"><code>scn::scan</code></th>
<th align="right"><code>scn::get_value</code></th>
<th align="right"><code>std::stringstream</code></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><code>float</code></td>
<td align="right">136</td>
<td align="right">130</td>
<td align="right">203</td>
</tr>
<tr class="even">
<td align="left"><code>double</code></td>
<td align="right">141</td>
<td align="right">135</td>
<td align="right">208</td>
</tr>
<tr class="odd">
<td align="left"><code>long double</code></td>
<td align="right">155</td>
<td align="right">143</td>
<td align="right">219</td>
</tr>
</tbody>
</table>
<h4 id="reading-random-whitespace-separated-stdbasic_strings">Reading random whitespace-separated <code>std::basic_string</code>s</h4>
<table>
<thead>
<tr class="header">
<th align="left">Character type</th>
<th align="right"><code>scn::scan</code></th>
<th align="right"><code>scn::get_value</code></th>
<th align="right"><code>std::stringstream</code></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><code>char</code></td>
<td align="right">51</td>
<td align="right">48</td>
<td align="right">46</td>
</tr>
<tr class="even">
<td align="left"><code>wchar_t</code></td>
<td align="right">71</td>
<td align="right">80</td>
<td align="right">110</td>
</tr>
</tbody>
</table>
<h4 id="reading-random-characters">Reading random characters</h4>
<table>
<thead>
<tr class="header">
<th align="left">Character type</th>
<th align="right"><code>scn::scan</code></th>
<th align="right"><code>scn::get_value</code></th>
<th align="right"><code>scn::getchar</code></th>
<th align="right"><code>std::stringstream</code></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><code>char</code></td>
<td align="right">20</td>
<td align="right">12</td>
<td align="right">5</td>
<td align="right">8</td>
</tr>
<tr class="even">
<td align="left"><code>wchar_t</code></td>
<td align="right">19</td>
<td align="right">12</td>
<td align="right">5</td>
<td align="right">15</td>
</tr>
</tbody>
</table>
<p>You can run the benchmarks yourself by enabling <code>SCN_BUILD_BENCHMARKS</code> and building the target <code>bench</code>. <code>SCN_BUILD_BENCHMARKS</code> is enabled by default if <code>scn</code> is the root CMake project, and disabled otherwise.</p>
<h3 id="code-size">Code size</h3>
<p>Code size benchmarks test code bloat for nontrivial projects. It generates 25 translation units and reads values from stdin* five times to simulate a medium sized project. The resulting executable size is shown in the following tables.</p>
<p>The code was compiled on Kubuntu 18.10 with g++ 8.2.0. <code>scnlib</code> is linked dynamically to level out the playing field compared to already dynamically linked <code>libc</code> and <code>libstdc++</code>. See the directory <code>benchmark/bloat</code> for more information, e.g. templates for each TU.</p>
<p>To run these tests yourself:</p>
<div class="sourceCode"><pre class="sourceCode sh"><code class="sourceCode bash">$ <span class="bu">cd</span> build
$ <span class="fu">cmake</span> -DCMAKE_BUILD_TYPE=Debug -DBUILD_SHARED_LIBS=ON -DSCN_INSTALL=OFF -DSCN_BLOAT=ON ..
$ <span class="fu">make</span> -j
$ <span class="ex">./benchmark/bloat/run-bloat-tests.py</span> ./benchmark/bloat</code></pre></div>
<p>*: <code>scn::ranges::scan</code> scans from a <code>Range</code>, not from stdin</p>
<p><code>(erased)</code> marks the usage of <code>scn::make_erased_stream()</code> instead of <code>scn::make_stream()</code>.</p>
<h4 id="minimized-build--os--dndebug">Minimized build (-Os -DNDEBUG)</h4>
<table>
<thead>
<tr class="header">
<th align="left">Method</th>
<th align="right">Executable size (KiB)</th>
<th align="right">Stripped size (KiB)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">empty</td>
<td align="right">18</td>
<td align="right">14</td>
</tr>
<tr class="even">
<td align="left"><code>scanf</code></td>
<td align="right">23</td>
<td align="right">18</td>
</tr>
<tr class="odd">
<td align="left"><code>std::istream</code> / <code>std::cin</code></td>
<td align="right">25</td>
<td align="right">18</td>
</tr>
<tr class="even">
<td align="left"><code>scn::input</code></td>
<td align="right">47</td>
<td align="right">38</td>
</tr>
<tr class="odd">
<td align="left"><code>scn::input</code> (erased)</td>
<td align="right">34</td>
<td align="right">26</td>
</tr>
<tr class="even">
<td align="left"><code>scn::ranges::scan</code></td>
<td align="right">94</td>
<td align="right">66</td>
</tr>
<tr class="odd">
<td align="left"><code>scn::input</code> (header only)</td>
<td align="right">191</td>
<td align="right">130</td>
</tr>
<tr class="even">
<td align="left"><code>scn::input</code> (header only &amp; erased)</td>
<td align="right">189</td>
<td align="right">130</td>
</tr>
<tr class="odd">
<td align="left"><code>scn::ranges::scan</code> (header only)</td>
<td align="right">194</td>
<td align="right">134</td>
</tr>
</tbody>
</table>
<h4 id="release-build--o3--dndebug">Release build (-O3 -DNDEBUG)</h4>
<table>
<thead>
<tr class="header">
<th align="left">Method</th>
<th align="right">Executable size (KiB)</th>
<th align="right">Stripped size (KiB)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">empty</td>
<td align="right">18</td>
<td align="right">14</td>
</tr>
<tr class="even">
<td align="left"><code>scanf</code></td>
<td align="right">24</td>
<td align="right">18</td>
</tr>
<tr class="odd">
<td align="left"><code>std::istream</code> / <code>std::cin</code></td>
<td align="right">30</td>
<td align="right">22</td>
</tr>
<tr class="even">
<td align="left"><code>scn::input</code></td>
<td align="right">52</td>
<td align="right">42</td>
</tr>
<tr class="odd">
<td align="left"><code>scn::input</code> (erased)</td>
<td align="right">42</td>
<td align="right">34</td>
</tr>
<tr class="even">
<td align="left"><code>scn::ranges::scan</code></td>
<td align="right">80</td>
<td align="right">70</td>
</tr>
<tr class="odd">
<td align="left"><code>scn::input</code> (header only)</td>
<td align="right">209</td>
<td align="right">170</td>
</tr>
<tr class="even">
<td align="left"><code>scn::input</code> (header only &amp; erased)</td>
<td align="right">277</td>
<td align="right">238</td>
</tr>
<tr class="odd">
<td align="left"><code>scn::ranges::scan</code> (header only)</td>
<td align="right">201</td>
<td align="right">166</td>
</tr>
</tbody>
</table>
<h4 id="debug-build--g">Debug build (-g)</h4>
<table>
<thead>
<tr class="header">
<th align="left">Method</th>
<th align="right">Executable size (KiB)</th>
<th align="right">Stripped size (KiB)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">empty</td>
<td align="right">29</td>
<td align="right">14</td>
</tr>
<tr class="even">
<td align="left"><code>scanf</code></td>
<td align="right">600</td>
<td align="right">18</td>
</tr>
<tr class="odd">
<td align="left"><code>std::istream</code> / <code>std::cin</code></td>
<td align="right">662</td>
<td align="right">22</td>
</tr>
<tr class="even">
<td align="left"><code>scn::input</code></td>
<td align="right">1910</td>
<td align="right">54</td>
</tr>
<tr class="odd">
<td align="left"><code>scn::input</code> (erased)</td>
<td align="right">1760</td>
<td align="right">46</td>
</tr>
<tr class="even">
<td align="left"><code>scn::ranges::scan</code></td>
<td align="right">5350</td>
<td align="right">554</td>
</tr>
<tr class="odd">
<td align="left"><code>scn::input</code> (header only)</td>
<td align="right">8460</td>
<td align="right">392</td>
</tr>
<tr class="even">
<td align="left"><code>scn::input</code> (header only &amp; erased)</td>
<td align="right">8140</td>
<td align="right">330</td>
</tr>
<tr class="odd">
<td align="left"><code>scn::ranges::scan</code> (header only)</td>
<td align="right">9300</td>
<td align="right">718</td>
</tr>
</tbody>
</table>
<h2 id="acknowledgements">Acknowledgements</h2>
<p>The contents of this library are heavily influenced by fmtlib and its derivative works.</p>
<p><a href="https://github.com/fmtlib/fmt" class="uri">https://github.com/fmtlib/fmt</a><br />
<a href="https://fmtlib.net" class="uri">https://fmtlib.net</a><br />
<a href="https://wg21.link/p0645" class="uri">https://wg21.link/p0645</a></p>
<p>fmtlib is licensed under the BSD 2-clause license.<br />
Copyright (c) 2012-2019 Victor Zverovich</p>
<h2 id="license">License</h2>
<p>Copyright (c) Elias Kosunen 2017-2019<br />
Apache License 2.0<br />
See LICENSE for further details</p>
