<p align="center">
<img src="https://github.com/fnc12/sqlite_orm/blob/master/logo.png" alt="Sublime's custom image" width="557"/>
</p>
<p><a href="https://en.cppreference.com/w/"><img
src="https://img.shields.io/badge/c++-%2300599C.svg?style=for-the-badge&amp;logo=c%2B%2B&amp;logoColor=white"
alt="C++" /></a> <a href="https://www.sqlite.org/index.html"><img
src="https://img.shields.io/badge/sqlite-%2307405e.svg?style=for-the-badge&amp;logo=sqlite&amp;logoColor=white"
alt="SQLite" /></a> <a
href="https://github.com/fnc12/sqlite_orm/actions"><img
src="https://img.shields.io/badge/githubactions-%232671E5.svg?style=for-the-badge&amp;logo=githubactions&amp;logoColor=white"
alt="GitHub Actions" /></a> <a
href="https://github.com/fnc12/sqlite_orm/blob/dev/CMakeLists.txt"><img
src="https://img.shields.io/badge/CMake-%23008FBA.svg?style=for-the-badge&amp;logo=cmake&amp;logoColor=white"
alt="CMake" /></a> <a
href="https://stackoverflow.com/search?q=sqlite_orm"><img
src="https://img.shields.io/badge/-Stackoverflow-FE7A16?style=for-the-badge&amp;logo=stack-overflow&amp;logoColor=white"
alt="Stack Overflow" /></a> <a href="https://paypal.me/fnc12"><img
src="https://img.shields.io/badge/PayPal-00457C?style=for-the-badge&amp;logo=paypal&amp;logoColor=white"
alt="PayPal" /></a> <a href="https://twitter.com/sqlite_orm"><img
src="https://img.shields.io/badge/sqlite_orm-%231DA1F2.svg?style=for-the-badge&amp;logo=Twitter&amp;logoColor=white"
alt="Twitter" /></a> <a href="https://patreon.com/fnc12"><img
src="https://img.shields.io/badge/Patreon-F96854?style=for-the-badge&amp;logo=patreon&amp;logoColor=white"
alt="Patreon" /></a></p>
<h1 id="sqlite-orm">SQLite ORM</h1>
<p>SQLite ORM light header only library for modern C++. Please read the
license precisely. The project has AGPL license for open source project
and MIT license after purchasing it for 50$ (using <a
href="https://paypal.me/fnc12">PayPal</a> or any different way (contact
using email fnc12@me.com)).</p>
<h1 id="status">Status</h1>
<table>
<colgroup>
<col style="width: 30%" />
<col style="width: 30%" />
<col style="width: 40%" />
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Branch</th>
<th style="text-align: left;">Travis</th>
<th style="text-align: left;">Appveyor</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><a
href="https://github.com/fnc12/sqlite_orm/tree/master"><code>master</code></a></td>
<td style="text-align: left;"><a
href="https://travis-ci.org/fnc12/sqlite_orm"><img
src="https://travis-ci.org/fnc12/sqlite_orm.svg?branch=master"
alt="Build Status" /></a></td>
<td style="text-align: left;"><a
href="https://ci.appveyor.com/project/fnc12/sqlite-orm/history"><img
src="https://ci.appveyor.com/api/projects/status/github/fnc12/sqlite_orm?branch=master&amp;svg=true"
alt="Build status" /></a></td>
</tr>
<tr class="even">
<td style="text-align: left;"><a
href="https://github.com/fnc12/sqlite_orm/tree/dev"><code>dev</code></a></td>
<td style="text-align: left;"><a
href="https://travis-ci.org/fnc12/sqlite_orm"><img
src="https://travis-ci.org/fnc12/sqlite_orm.svg?branch=dev"
alt="Build Status" /></a></td>
<td style="text-align: left;"><a
href="https://ci.appveyor.com/project/fnc12/sqlite-orm/history"><img
src="https://ci.appveyor.com/api/projects/status/github/fnc12/sqlite_orm?branch=dev&amp;svg=true"
alt="Build status" /></a></td>
</tr>
</tbody>
</table>
<h1 id="advantages">Advantages</h1>
<ul>
<li><strong>No raw string queries</strong></li>
<li><strong>Intuitive syntax</strong></li>
<li><strong>Comfortable interface - one code line per single
query</strong></li>
<li><strong>Built with modern C++14/C++17/C++20 features (no macros and
external scripts)</strong></li>
<li><strong>CRUD support</strong></li>
<li><strong>Pure select query support</strong></li>
<li><strong>Prepared statements support</strong></li>
<li><strong>UNION, EXCEPT and INTERSECT support</strong></li>
<li><strong>STL compatible</strong></li>
<li><strong>Custom types binding support</strong></li>
<li><strong>BLOB support</strong> - maps to
<code>std::vector&lt;char&gt;</code> or one can bind your custom
type</li>
<li><strong>FOREIGN KEY support</strong></li>
<li><strong>Composite key support</strong></li>
<li><strong>JOIN support</strong></li>
<li><strong>Transactions support</strong></li>
<li><strong>Migrations functionality</strong></li>
<li><strong>Powerful conditions</strong></li>
<li><strong>ORDER BY and LIMIT, OFFSET support</strong></li>
<li><strong>GROUP BY / DISTINCT support</strong></li>
<li><strong>INDEX support</strong></li>
<li><strong>Follows single responsibility principle</strong> - no need
write code inside your data model classes</li>
<li><strong>Easy integration</strong> - single header only lib.</li>
<li><strong>The only dependency</strong> - libsqlite3</li>
<li><strong>C++ standard code style</strong></li>
<li><strong>In memory database support</strong> - provide
<code>:memory:</code> or empty filename</li>
<li><strong>COLLATE support</strong></li>
<li><strong>Limits setting/getting support</strong></li>
<li><strong>User defined functions support</strong></li>
</ul>
<p><code>sqlite_orm</code> library allows to create easy data model
mappings to your database schema. It is built to manage (CRUD) objects
with a primary key and without it. It also allows you to specify table
names and column names explicitly no matter how your classes actually
named. Take a look at example:</p>
<div class="sourceCode" id="cb1"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="kw">struct</span> User<span class="op">{</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> id<span class="op">;</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>    <span class="bu">std::</span>string firstName<span class="op">;</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>    <span class="bu">std::</span>string lastName<span class="op">;</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> birthDate<span class="op">;</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>    <span class="bu">std::</span>unique_ptr<span class="op">&lt;</span><span class="bu">std::</span>string<span class="op">&gt;</span> imageUrl<span class="op">;</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> typeId<span class="op">;</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="op">};</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="kw">struct</span> UserType <span class="op">{</span></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> id<span class="op">;</span></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>    <span class="bu">std::</span>string name<span class="op">;</span></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="op">};</span></span></code></pre></div>
<p>So we have database with predefined schema like</p>
<p><code>CREATE TABLE users (id integer primary key autoincrement, first_name text not null, last_name text not null, birth_date integer not null, image_url text, type_id integer not null)</code></p>
<p><code>CREATE TABLE user_types (id integer primary key autoincrement, name text not null DEFAULT 'name_placeholder')</code></p>
<p>Now we tell <code>sqlite_orm</code> library about our schema and
provide database filename. We create <code>storage</code> service object
that has CRUD interface. Also we create every table and every column.
All code is intuitive and minimalistic.</p>
<div class="sourceCode" id="cb2"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="kw">using</span> <span class="kw">namespace</span> sqlite_orm<span class="op">;</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="kw">auto</span> storage <span class="op">=</span> make_storage<span class="op">(</span><span class="st">&quot;db.sqlite&quot;</span><span class="op">,</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>                            make_table<span class="op">(</span><span class="st">&quot;users&quot;</span><span class="op">,</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>                                       make_column<span class="op">(</span><span class="st">&quot;id&quot;</span><span class="op">,</span> <span class="op">&amp;</span>User<span class="op">::</span>id<span class="op">,</span> primary_key<span class="op">().</span>autoincrement<span class="op">()),</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>                                       make_column<span class="op">(</span><span class="st">&quot;first_name&quot;</span><span class="op">,</span> <span class="op">&amp;</span>User<span class="op">::</span>firstName<span class="op">),</span></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>                                       make_column<span class="op">(</span><span class="st">&quot;last_name&quot;</span><span class="op">,</span> <span class="op">&amp;</span>User<span class="op">::</span>lastName<span class="op">),</span></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>                                       make_column<span class="op">(</span><span class="st">&quot;birth_date&quot;</span><span class="op">,</span> <span class="op">&amp;</span>User<span class="op">::</span>birthDate<span class="op">),</span></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>                                       make_column<span class="op">(</span><span class="st">&quot;image_url&quot;</span><span class="op">,</span> <span class="op">&amp;</span>User<span class="op">::</span>imageUrl<span class="op">),</span></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>                                       make_column<span class="op">(</span><span class="st">&quot;type_id&quot;</span><span class="op">,</span> <span class="op">&amp;</span>User<span class="op">::</span>typeId<span class="op">)),</span></span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>                            make_table<span class="op">(</span><span class="st">&quot;user_types&quot;</span><span class="op">,</span></span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>                                       make_column<span class="op">(</span><span class="st">&quot;id&quot;</span><span class="op">,</span> <span class="op">&amp;</span>UserType<span class="op">::</span>id<span class="op">,</span> primary_key<span class="op">().</span>autoincrement<span class="op">()),</span></span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>                                       make_column<span class="op">(</span><span class="st">&quot;name&quot;</span><span class="op">,</span> <span class="op">&amp;</span>UserType<span class="op">::</span>name<span class="op">,</span> default_value<span class="op">(</span><span class="st">&quot;name_placeholder&quot;</span><span class="op">))));</span></span></code></pre></div>
<p>Too easy isn’t it? You do not have to specify mapped type explicitly
- it is deduced from your member pointers you pass during making a
column (for example: <code>&amp;User::id</code>). To create a column you
have to pass two arguments at least: its name in the table and your
mapped class member pointer. You can also add extra arguments to tell
your storage about column’s constraints like <code>primary_key</code>,
<code>autoincrement</code>, <code>default_value</code>,
<code>unique</code> or <code>generated_always_as</code> (order isn’t
important; <code>not_null</code>/<code>null</code> are deduced from type
automatically but can be added manually if you wish with
<code>null()</code> and <code>not_null()</code>).</p>
<p>More details about making storage can be found in <a
href="https://github.com/fnc12/sqlite_orm/wiki/Making-a-storage">tutorial</a>.</p>
<p>If your datamodel classes have private or protected members to map to
sqlite then you can make a storage with setter and getter functions.
More info in the <a
href="https://github.com/fnc12/sqlite_orm/blob/master/examples/private_class_members.cpp">example</a>.</p>
<h1 id="crud">CRUD</h1>
<p>Let’s create and insert new <code>User</code> into our database.
First we need to create a <code>User</code> object with any id and call
<code>insert</code> function. It will return id of just created user or
throw exception if something goes wrong.</p>
<div class="sourceCode" id="cb3"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>User user<span class="op">{-</span><span class="dv">1</span><span class="op">,</span> <span class="st">&quot;Jonh&quot;</span><span class="op">,</span> <span class="st">&quot;Doe&quot;</span><span class="op">,</span> <span class="dv">664416000</span><span class="op">,</span> <span class="bu">std::</span>make_unique<span class="op">&lt;</span><span class="bu">std::</span>string<span class="op">&gt;(</span><span class="st">&quot;url_to_heaven&quot;</span><span class="op">),</span> <span class="dv">3</span> <span class="op">};</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="kw">auto</span> insertedId <span class="op">=</span> storage<span class="op">.</span>insert<span class="op">(</span>user<span class="op">);</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>cout <span class="op">&lt;&lt;</span> <span class="st">&quot;insertedId = &quot;</span> <span class="op">&lt;&lt;</span> insertedId <span class="op">&lt;&lt;</span> endl<span class="op">;</span>      <span class="co">//  insertedId = 8</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>user<span class="op">.</span>id <span class="op">=</span> insertedId<span class="op">;</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>User secondUser<span class="op">{-</span><span class="dv">1</span><span class="op">,</span> <span class="st">&quot;Alice&quot;</span><span class="op">,</span> <span class="st">&quot;Inwonder&quot;</span><span class="op">,</span> <span class="dv">831168000</span><span class="op">,</span> <span class="op">{}</span> <span class="op">,</span> <span class="dv">2</span><span class="op">};</span></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>insertedId <span class="op">=</span> storage<span class="op">.</span>insert<span class="op">(</span>secondUser<span class="op">);</span></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>secondUser<span class="op">.</span>id <span class="op">=</span> insertedId<span class="op">;</span></span></code></pre></div>
<p>Note: if we need to insert a new user with specified id call
<code>storage.replace(user);</code> instead of <code>insert</code>.</p>
<p>Next let’s get our user by id.</p>
<div class="sourceCode" id="cb4"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="cf">try</span><span class="op">{</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>    <span class="kw">auto</span> user <span class="op">=</span> storage<span class="op">.</span>get<span class="op">&lt;</span>User<span class="op">&gt;(</span>insertedId<span class="op">);</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>    cout <span class="op">&lt;&lt;</span> <span class="st">&quot;user = &quot;</span> <span class="op">&lt;&lt;</span> user<span class="op">.</span>firstName <span class="op">&lt;&lt;</span> <span class="st">&quot; &quot;</span> <span class="op">&lt;&lt;</span> user<span class="op">.</span>lastName <span class="op">&lt;&lt;</span> endl<span class="op">;</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a><span class="op">}</span><span class="cf">catch</span><span class="op">(</span><span class="bu">std::</span>system_error e<span class="op">)</span> <span class="op">{</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>    cout <span class="op">&lt;&lt;</span> e<span class="op">.</span>what<span class="op">()</span> <span class="op">&lt;&lt;</span> endl<span class="op">;</span></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a><span class="op">}</span><span class="cf">catch</span><span class="op">(...){</span></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>    cout <span class="op">&lt;&lt;</span> <span class="st">&quot;unknown exeption&quot;</span> <span class="op">&lt;&lt;</span> endl<span class="op">;</span></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<p>Probably you may not like throwing exceptions. Me too. Exception
<code>std::system_error</code> is thrown because return type in
<code>get</code> function is not nullable. You can use alternative
version <code>get_pointer</code> which returns
<code>std::unique_ptr</code> and doesn’t throw
<code>not_found_exception</code> if nothing found - just returns
<code>nullptr</code>.</p>
<div class="sourceCode" id="cb5"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span><span class="op">(</span><span class="kw">auto</span> user <span class="op">=</span> storage<span class="op">.</span>get_pointer<span class="op">&lt;</span>User<span class="op">&gt;(</span>insertedId<span class="op">)){</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>    cout <span class="op">&lt;&lt;</span> <span class="st">&quot;user = &quot;</span> <span class="op">&lt;&lt;</span> user<span class="op">-&gt;</span>firstName <span class="op">&lt;&lt;</span> <span class="st">&quot; &quot;</span> <span class="op">&lt;&lt;</span> user<span class="op">-&gt;</span>lastName <span class="op">&lt;&lt;</span> endl<span class="op">;</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="op">}</span><span class="cf">else</span><span class="op">{</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>    cout <span class="op">&lt;&lt;</span> <span class="st">&quot;no user with id &quot;</span> <span class="op">&lt;&lt;</span> insertedId <span class="op">&lt;&lt;</span> endl<span class="op">;</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<p><code>std::unique_ptr</code> is used as optional in
<code>sqlite_orm</code>. Of course there is class optional in C++14
located at <code>std::experimental::optional</code>. But we don’t want
to use it until it is <code>experimental</code>.</p>
<p>We can also update our user. It updates row by id provided in
<code>user</code> object and sets all other non <code>primary_key</code>
fields to values stored in the passed <code>user</code> object. So you
can just assign members to <code>user</code> object you want and call
<code>update</code></p>
<div class="sourceCode" id="cb6"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>user<span class="op">.</span>firstName <span class="op">=</span> <span class="st">&quot;Nicholas&quot;</span><span class="op">;</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>user<span class="op">.</span>imageUrl <span class="op">=</span> <span class="st">&quot;https://cdn1.iconfinder.com/data/icons/man-icon-set/100/man_icon-21-512.png&quot;</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>storage<span class="op">.</span>update<span class="op">(</span>user<span class="op">);</span></span></code></pre></div>
<p>Also there is a non-CRUD update version <code>update_all</code>:</p>
<div class="sourceCode" id="cb7"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>storage<span class="op">.</span>update_all<span class="op">(</span>set<span class="op">(</span>c<span class="op">(&amp;</span>User<span class="op">::</span>lastName<span class="op">)</span> <span class="op">=</span> <span class="st">&quot;Hardey&quot;</span><span class="op">,</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>                       c<span class="op">(&amp;</span>User<span class="op">::</span>typeId<span class="op">)</span> <span class="op">=</span> <span class="dv">2</span><span class="op">),</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>                   where<span class="op">(</span>c<span class="op">(&amp;</span>User<span class="op">::</span>firstName<span class="op">)</span> <span class="op">==</span> <span class="st">&quot;Tom&quot;</span><span class="op">));</span></span></code></pre></div>
<p>And delete. To delete you have to pass id only, not whole object.
Also we need to explicitly tell which class of object we want to delete.
Function name is <code>remove</code> not <code>delete</code> cause
<code>delete</code> is a reserved word in C++.</p>
<div class="sourceCode" id="cb8"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>storage<span class="op">.</span>remove<span class="op">&lt;</span>User<span class="op">&gt;(</span>insertedId<span class="op">)</span></span></code></pre></div>
<p>Also we can extract all objects into <code>std::vector</code>.</p>
<div class="sourceCode" id="cb9"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="kw">auto</span> allUsers <span class="op">=</span> storage<span class="op">.</span>get_all<span class="op">&lt;</span>User<span class="op">&gt;();</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>cout <span class="op">&lt;&lt;</span> <span class="st">&quot;allUsers (&quot;</span> <span class="op">&lt;&lt;</span> allUsers<span class="op">.</span>size<span class="op">()</span> <span class="op">&lt;&lt;</span> <span class="st">&quot;):&quot;</span> <span class="op">&lt;&lt;</span> endl<span class="op">;</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span><span class="op">(</span><span class="kw">auto</span> <span class="op">&amp;</span>user <span class="op">:</span> allUsers<span class="op">)</span> <span class="op">{</span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>    cout <span class="op">&lt;&lt;</span> storage<span class="op">.</span>dump<span class="op">(</span>user<span class="op">)</span> <span class="op">&lt;&lt;</span> endl<span class="op">;</span> <span class="co">//  dump returns std::string with json-like style object info. For example: { id : &#39;1&#39;, first_name : &#39;Jonh&#39;, last_name : &#39;Doe&#39;, birth_date : &#39;664416000&#39;, image_url : &#39;https://cdn1.iconfinder.com/data/icons/man-icon-set/100/man_icon-21-512.png&#39;, type_id : &#39;3&#39; }</span></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<p>And one can specify return container type explicitly: let’s get all
users in <code>std::list</code>, not <code>std::vector</code>:</p>
<div class="sourceCode" id="cb10"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="kw">auto</span> allUsersList <span class="op">=</span> storage<span class="op">.</span>get_all<span class="op">&lt;</span>User<span class="op">,</span> <span class="bu">std::</span>list<span class="op">&lt;</span>User<span class="op">&gt;&gt;();</span></span></code></pre></div>
<p>Container must be STL compatible (must have
<code>push_back(T&amp;&amp;)</code> function in this case).</p>
<p><code>get_all</code> can be too heavy for memory so you can iterate
row by row (i.e. object by object):</p>
<div class="sourceCode" id="cb11"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span><span class="op">(</span><span class="kw">auto</span> <span class="op">&amp;</span>user <span class="op">:</span> storage<span class="op">.</span>iterate<span class="op">&lt;</span>User<span class="op">&gt;())</span> <span class="op">{</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>    cout <span class="op">&lt;&lt;</span> storage<span class="op">.</span>dump<span class="op">(</span>user<span class="op">)</span> <span class="op">&lt;&lt;</span> endl<span class="op">;</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<p><code>iterate</code> member function returns adapter object that has
<code>begin</code> and <code>end</code> member functions returning
iterators that fetch object on dereference operator call.</p>
<p>CRUD functions <code>get</code>, <code>get_pointer</code>,
<code>remove</code>, <code>update</code> (not <code>insert</code>) work
only if your type has a primary key column. If you try to
<code>get</code> an object that is mapped to your storage but has no
primary key column a <code>std::system_error</code> will be thrown cause
<code>sqlite_orm</code> cannot detect an id. If you want to know how to
perform a storage without primary key take a look at
<code>date_time.cpp</code> example in <code>examples</code> folder.</p>
<h1 id="prepared-statements">Prepared statements</h1>
<p>Prepared statements are strongly typed.</p>
<div class="sourceCode" id="cb12"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co">//  SELECT doctor_id</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="co">//  FROM visits</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a><span class="co">//  WHERE LENGTH(patient_name) &gt; 8</span></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a><span class="kw">auto</span> selectStatement <span class="op">=</span> storage<span class="op">.</span>prepare<span class="op">(</span>select<span class="op">(&amp;</span>Visit<span class="op">::</span>doctor_id<span class="op">,</span> where<span class="op">(</span>length<span class="op">(&amp;</span>Visit<span class="op">::</span>patient_name<span class="op">)</span> <span class="op">&gt;</span> <span class="dv">8</span><span class="op">)));</span></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>cout <span class="op">&lt;&lt;</span> <span class="st">&quot;selectStatement = &quot;</span> <span class="op">&lt;&lt;</span> selectStatement<span class="op">.</span>sql<span class="op">()</span> <span class="op">&lt;&lt;</span> endl<span class="op">;</span>  <span class="co">//  prints &quot;SELECT doctor_id FROM ...&quot;</span></span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a><span class="kw">auto</span> rows <span class="op">=</span> storage<span class="op">.</span>execute<span class="op">(</span>selectStatement<span class="op">);</span> <span class="co">//  rows is std::vector&lt;decltype(Visit::doctor_id)&gt;</span></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a><span class="co">//  SELECT doctor_id</span></span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a><span class="co">//  FROM visits</span></span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a><span class="co">//  WHERE LENGTH(patient_name) &gt; 11</span></span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a>get<span class="op">&lt;</span><span class="dv">0</span><span class="op">&gt;(</span>selectStatement<span class="op">)</span> <span class="op">=</span> <span class="dv">11</span><span class="op">;</span></span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a><span class="kw">auto</span> rows2 <span class="op">=</span> storage<span class="op">.</span>execute<span class="op">(</span>selectStatement<span class="op">);</span></span></code></pre></div>
<p><code>get&lt;N&gt;(statement)</code> function call allows you to
access fields to bind them to your statement.</p>
<h1 id="aggregate-functions">Aggregate Functions</h1>
<div class="sourceCode" id="cb13"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co">//  SELECT AVG(id) FROM users</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="kw">auto</span> averageId <span class="op">=</span> storage<span class="op">.</span>avg<span class="op">(&amp;</span>User<span class="op">::</span>id<span class="op">);</span>    </span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>cout <span class="op">&lt;&lt;</span> <span class="st">&quot;averageId = &quot;</span> <span class="op">&lt;&lt;</span> averageId <span class="op">&lt;&lt;</span> endl<span class="op">;</span>        <span class="co">//  averageId = 4.5</span></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a><span class="co">//  SELECT AVG(birth_date) FROM users</span></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a><span class="kw">auto</span> averageBirthDate <span class="op">=</span> storage<span class="op">.</span>avg<span class="op">(&amp;</span>User<span class="op">::</span>birthDate<span class="op">);</span>  </span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>cout <span class="op">&lt;&lt;</span> <span class="st">&quot;averageBirthDate = &quot;</span> <span class="op">&lt;&lt;</span> averageBirthDate <span class="op">&lt;&lt;</span> endl<span class="op">;</span>      <span class="co">//  averageBirthDate = 6.64416e+08</span></span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a><span class="co">//  SELECT COUNT(*) FROM users</span></span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a><span class="kw">auto</span> usersCount <span class="op">=</span> storage<span class="op">.</span>count<span class="op">&lt;</span>User<span class="op">&gt;();</span>    </span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a>cout <span class="op">&lt;&lt;</span> <span class="st">&quot;users count = &quot;</span> <span class="op">&lt;&lt;</span> usersCount <span class="op">&lt;&lt;</span> endl<span class="op">;</span>     <span class="co">//  users count = 8</span></span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a><span class="co">//  SELECT COUNT(id) FROM users</span></span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a><span class="kw">auto</span> countId <span class="op">=</span> storage<span class="op">.</span>count<span class="op">(&amp;</span>User<span class="op">::</span>id<span class="op">);</span>    </span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a>cout <span class="op">&lt;&lt;</span> <span class="st">&quot;countId = &quot;</span> <span class="op">&lt;&lt;</span> countId <span class="op">&lt;&lt;</span> endl<span class="op">;</span>        <span class="co">//  countId = 8</span></span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-17"><a href="#cb13-17" aria-hidden="true" tabindex="-1"></a><span class="co">//  SELECT COUNT(image_url) FROM users</span></span>
<span id="cb13-18"><a href="#cb13-18" aria-hidden="true" tabindex="-1"></a><span class="kw">auto</span> countImageUrl <span class="op">=</span> storage<span class="op">.</span>count<span class="op">(&amp;</span>User<span class="op">::</span>imageUrl<span class="op">);</span>   </span>
<span id="cb13-19"><a href="#cb13-19" aria-hidden="true" tabindex="-1"></a>cout <span class="op">&lt;&lt;</span> <span class="st">&quot;countImageUrl = &quot;</span> <span class="op">&lt;&lt;</span> countImageUrl <span class="op">&lt;&lt;</span> endl<span class="op">;</span>      <span class="co">//  countImageUrl = 5</span></span>
<span id="cb13-20"><a href="#cb13-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-21"><a href="#cb13-21" aria-hidden="true" tabindex="-1"></a><span class="co">//  SELECT GROUP_CONCAT(id) FROM users</span></span>
<span id="cb13-22"><a href="#cb13-22" aria-hidden="true" tabindex="-1"></a><span class="kw">auto</span> concatedUserId <span class="op">=</span> storage<span class="op">.</span>group_concat<span class="op">(&amp;</span>User<span class="op">::</span>id<span class="op">);</span>      </span>
<span id="cb13-23"><a href="#cb13-23" aria-hidden="true" tabindex="-1"></a>cout <span class="op">&lt;&lt;</span> <span class="st">&quot;concatedUserId = &quot;</span> <span class="op">&lt;&lt;</span> concatedUserId <span class="op">&lt;&lt;</span> endl<span class="op">;</span>      <span class="co">//  concatedUserId = 1,2,3,4,5,6,7,8</span></span>
<span id="cb13-24"><a href="#cb13-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-25"><a href="#cb13-25" aria-hidden="true" tabindex="-1"></a><span class="co">//  SELECT GROUP_CONCAT(id, &quot;---&quot;) FROM users</span></span>
<span id="cb13-26"><a href="#cb13-26" aria-hidden="true" tabindex="-1"></a><span class="kw">auto</span> concatedUserIdWithDashes <span class="op">=</span> storage<span class="op">.</span>group_concat<span class="op">(&amp;</span>User<span class="op">::</span>id<span class="op">,</span> <span class="st">&quot;---&quot;</span><span class="op">);</span>     </span>
<span id="cb13-27"><a href="#cb13-27" aria-hidden="true" tabindex="-1"></a>cout <span class="op">&lt;&lt;</span> <span class="st">&quot;concatedUserIdWithDashes = &quot;</span> <span class="op">&lt;&lt;</span> concatedUserIdWithDashes <span class="op">&lt;&lt;</span> endl<span class="op">;</span>      <span class="co">//  concatedUserIdWithDashes = 1---2---3---4---5---6---7---8</span></span>
<span id="cb13-28"><a href="#cb13-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-29"><a href="#cb13-29" aria-hidden="true" tabindex="-1"></a><span class="co">//  SELECT MAX(id) FROM users</span></span>
<span id="cb13-30"><a href="#cb13-30" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span><span class="op">(</span><span class="kw">auto</span> maxId <span class="op">=</span> storage<span class="op">.</span>max<span class="op">(&amp;</span>User<span class="op">::</span>id<span class="op">)){</span>    </span>
<span id="cb13-31"><a href="#cb13-31" aria-hidden="true" tabindex="-1"></a>    cout <span class="op">&lt;&lt;</span> <span class="st">&quot;maxId = &quot;</span> <span class="op">&lt;&lt;</span> <span class="op">*</span>maxId <span class="op">&lt;&lt;</span>endl<span class="op">;</span>    <span class="co">//  maxId = 12  (maxId is std::unique_ptr&lt;int&gt;)</span></span>
<span id="cb13-32"><a href="#cb13-32" aria-hidden="true" tabindex="-1"></a><span class="op">}</span><span class="cf">else</span><span class="op">{</span></span>
<span id="cb13-33"><a href="#cb13-33" aria-hidden="true" tabindex="-1"></a>    cout <span class="op">&lt;&lt;</span> <span class="st">&quot;maxId is null&quot;</span> <span class="op">&lt;&lt;</span> endl<span class="op">;</span></span>
<span id="cb13-34"><a href="#cb13-34" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb13-35"><a href="#cb13-35" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb13-36"><a href="#cb13-36" aria-hidden="true" tabindex="-1"></a><span class="co">//  SELECT MAX(first_name) FROM users</span></span>
<span id="cb13-37"><a href="#cb13-37" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span><span class="op">(</span><span class="kw">auto</span> maxFirstName <span class="op">=</span> storage<span class="op">.</span>max<span class="op">(&amp;</span>User<span class="op">::</span>firstName<span class="op">)){</span> </span>
<span id="cb13-38"><a href="#cb13-38" aria-hidden="true" tabindex="-1"></a>    cout <span class="op">&lt;&lt;</span> <span class="st">&quot;maxFirstName = &quot;</span> <span class="op">&lt;&lt;</span> <span class="op">*</span>maxFirstName <span class="op">&lt;&lt;</span> endl<span class="op">;</span> <span class="co">//  maxFirstName = Jonh (maxFirstName is std::unique_ptr&lt;std::string&gt;)</span></span>
<span id="cb13-39"><a href="#cb13-39" aria-hidden="true" tabindex="-1"></a><span class="op">}</span><span class="cf">else</span><span class="op">{</span></span>
<span id="cb13-40"><a href="#cb13-40" aria-hidden="true" tabindex="-1"></a>    cout <span class="op">&lt;&lt;</span> <span class="st">&quot;maxFirstName is null&quot;</span> <span class="op">&lt;&lt;</span> endl<span class="op">;</span></span>
<span id="cb13-41"><a href="#cb13-41" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb13-42"><a href="#cb13-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-43"><a href="#cb13-43" aria-hidden="true" tabindex="-1"></a><span class="co">//  SELECT MIN(id) FROM users</span></span>
<span id="cb13-44"><a href="#cb13-44" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span><span class="op">(</span><span class="kw">auto</span> minId <span class="op">=</span> storage<span class="op">.</span>min<span class="op">(&amp;</span>User<span class="op">::</span>id<span class="op">)){</span>    </span>
<span id="cb13-45"><a href="#cb13-45" aria-hidden="true" tabindex="-1"></a>    cout <span class="op">&lt;&lt;</span> <span class="st">&quot;minId = &quot;</span> <span class="op">&lt;&lt;</span> <span class="op">*</span>minId <span class="op">&lt;&lt;</span> endl<span class="op">;</span>   <span class="co">//  minId = 1 (minId is std::unique_ptr&lt;int&gt;)</span></span>
<span id="cb13-46"><a href="#cb13-46" aria-hidden="true" tabindex="-1"></a><span class="op">}</span><span class="cf">else</span><span class="op">{</span></span>
<span id="cb13-47"><a href="#cb13-47" aria-hidden="true" tabindex="-1"></a>    cout <span class="op">&lt;&lt;</span> <span class="st">&quot;minId is null&quot;</span> <span class="op">&lt;&lt;</span> endl<span class="op">;</span></span>
<span id="cb13-48"><a href="#cb13-48" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb13-49"><a href="#cb13-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-50"><a href="#cb13-50" aria-hidden="true" tabindex="-1"></a><span class="co">//  SELECT MIN(last_name) FROM users</span></span>
<span id="cb13-51"><a href="#cb13-51" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span><span class="op">(</span><span class="kw">auto</span> minLastName <span class="op">=</span> storage<span class="op">.</span>min<span class="op">(&amp;</span>User<span class="op">::</span>lastName<span class="op">)){</span></span>
<span id="cb13-52"><a href="#cb13-52" aria-hidden="true" tabindex="-1"></a>    cout <span class="op">&lt;&lt;</span> <span class="st">&quot;minLastName = &quot;</span> <span class="op">&lt;&lt;</span> <span class="op">*</span>minLastName <span class="op">&lt;&lt;</span> endl<span class="op">;</span>   <span class="co">//  minLastName = Doe</span></span>
<span id="cb13-53"><a href="#cb13-53" aria-hidden="true" tabindex="-1"></a><span class="op">}</span><span class="cf">else</span><span class="op">{</span></span>
<span id="cb13-54"><a href="#cb13-54" aria-hidden="true" tabindex="-1"></a>    cout <span class="op">&lt;&lt;</span> <span class="st">&quot;minLastName is null&quot;</span> <span class="op">&lt;&lt;</span> endl<span class="op">;</span></span>
<span id="cb13-55"><a href="#cb13-55" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb13-56"><a href="#cb13-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-57"><a href="#cb13-57" aria-hidden="true" tabindex="-1"></a><span class="co">//  SELECT SUM(id) FROM users</span></span>
<span id="cb13-58"><a href="#cb13-58" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span><span class="op">(</span><span class="kw">auto</span> sumId <span class="op">=</span> storage<span class="op">.</span>sum<span class="op">(&amp;</span>User<span class="op">::</span>id<span class="op">)){</span>    <span class="co">//  sumId is std::unique_ptr&lt;int&gt;</span></span>
<span id="cb13-59"><a href="#cb13-59" aria-hidden="true" tabindex="-1"></a>    cout <span class="op">&lt;&lt;</span> <span class="st">&quot;sumId = &quot;</span> <span class="op">&lt;&lt;</span> <span class="op">*</span>sumId <span class="op">&lt;&lt;</span> endl<span class="op">;</span></span>
<span id="cb13-60"><a href="#cb13-60" aria-hidden="true" tabindex="-1"></a><span class="op">}</span><span class="cf">else</span><span class="op">{</span></span>
<span id="cb13-61"><a href="#cb13-61" aria-hidden="true" tabindex="-1"></a>    cout <span class="op">&lt;&lt;</span> <span class="st">&quot;sumId is null&quot;</span> <span class="op">&lt;&lt;</span> endl<span class="op">;</span></span>
<span id="cb13-62"><a href="#cb13-62" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb13-63"><a href="#cb13-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-64"><a href="#cb13-64" aria-hidden="true" tabindex="-1"></a><span class="co">//  SELECT TOTAL(id) FROM users</span></span>
<span id="cb13-65"><a href="#cb13-65" aria-hidden="true" tabindex="-1"></a><span class="kw">auto</span> totalId <span class="op">=</span> storage<span class="op">.</span>total<span class="op">(&amp;</span>User<span class="op">::</span>id<span class="op">);</span></span>
<span id="cb13-66"><a href="#cb13-66" aria-hidden="true" tabindex="-1"></a>cout <span class="op">&lt;&lt;</span> <span class="st">&quot;totalId = &quot;</span> <span class="op">&lt;&lt;</span> totalId <span class="op">&lt;&lt;</span> endl<span class="op">;</span>    <span class="co">//  totalId is double (always)</span></span></code></pre></div>
<h1 id="where-conditions">Where conditions</h1>
<p>You also can select objects with custom where conditions with
<code>=</code>, <code>!=</code>, <code>&gt;</code>, <code>&gt;=</code>,
<code>&lt;</code>, <code>&lt;=</code>, <code>IN</code>,
<code>BETWEEN</code> and <code>LIKE</code>.</p>
<p>For example: let’s select users with id lesser than 10:</p>
<div class="sourceCode" id="cb14"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co">//  SELECT * FROM users WHERE id &lt; 10</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="kw">auto</span> idLesserThan10 <span class="op">=</span> storage<span class="op">.</span>get_all<span class="op">&lt;</span>User<span class="op">&gt;(</span>where<span class="op">(</span>c<span class="op">(&amp;</span>User<span class="op">::</span>id<span class="op">)</span> <span class="op">&lt;</span> <span class="dv">10</span><span class="op">));</span></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>cout <span class="op">&lt;&lt;</span> <span class="st">&quot;idLesserThan10 count = &quot;</span> <span class="op">&lt;&lt;</span> idLesserThan10<span class="op">.</span>size<span class="op">()</span> <span class="op">&lt;&lt;</span> endl<span class="op">;</span></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span><span class="op">(</span><span class="kw">auto</span> <span class="op">&amp;</span>user <span class="op">:</span> idLesserThan10<span class="op">)</span> <span class="op">{</span></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>    cout <span class="op">&lt;&lt;</span> storage<span class="op">.</span>dump<span class="op">(</span>user<span class="op">)</span> <span class="op">&lt;&lt;</span> endl<span class="op">;</span></span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<p>Or select all users who’s first name is not equal “John”:</p>
<div class="sourceCode" id="cb15"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co">//  SELECT * FROM users WHERE first_name != &#39;John&#39;</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="kw">auto</span> notJohn <span class="op">=</span> storage<span class="op">.</span>get_all<span class="op">&lt;</span>User<span class="op">&gt;(</span>where<span class="op">(</span>c<span class="op">(&amp;</span>User<span class="op">::</span>firstName<span class="op">)</span> <span class="op">!=</span> <span class="st">&quot;John&quot;</span><span class="op">));</span></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>cout <span class="op">&lt;&lt;</span> <span class="st">&quot;notJohn count = &quot;</span> <span class="op">&lt;&lt;</span> notJohn<span class="op">.</span>size<span class="op">()</span> <span class="op">&lt;&lt;</span> endl<span class="op">;</span></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span><span class="op">(</span><span class="kw">auto</span> <span class="op">&amp;</span>user <span class="op">:</span> notJohn<span class="op">)</span> <span class="op">{</span></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>    cout <span class="op">&lt;&lt;</span> storage<span class="op">.</span>dump<span class="op">(</span>user<span class="op">)</span> <span class="op">&lt;&lt;</span> endl<span class="op">;</span></span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<p>By the way one can implement not equal in a different way using C++
negation operator:</p>
<div class="sourceCode" id="cb16"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="kw">auto</span> notJohn2 <span class="op">=</span> storage<span class="op">.</span>get_all<span class="op">&lt;</span>User<span class="op">&gt;(</span>where<span class="op">(</span><span class="kw">not</span> <span class="op">(</span>c<span class="op">(&amp;</span>User<span class="op">::</span>firstName<span class="op">)</span> <span class="op">==</span> <span class="st">&quot;John&quot;</span><span class="op">)));</span></span></code></pre></div>
<p>You can use <code>!</code> and <code>not</code> in this case cause
they are equal. Also you can chain several conditions with
<code>and</code> and <code>or</code> operators. Let’s try to get users
with query with conditions like
<code>where id &gt;= 5 and id &lt;= 7 and not id = 6</code>:</p>
<div class="sourceCode" id="cb17"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="kw">auto</span> id5and7 <span class="op">=</span> storage<span class="op">.</span>get_all<span class="op">&lt;</span>User<span class="op">&gt;(</span>where<span class="op">(</span>c<span class="op">(&amp;</span>User<span class="op">::</span>id<span class="op">)</span> <span class="op">&lt;=</span> <span class="dv">7</span> <span class="kw">and</span> c<span class="op">(&amp;</span>User<span class="op">::</span>id<span class="op">)</span> <span class="op">&gt;=</span> <span class="dv">5</span> <span class="kw">and</span> <span class="kw">not</span> <span class="op">(</span>c<span class="op">(&amp;</span>User<span class="op">::</span>id<span class="op">)</span> <span class="op">==</span> <span class="dv">6</span><span class="op">)));</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>cout <span class="op">&lt;&lt;</span> <span class="st">&quot;id5and7 count = &quot;</span> <span class="op">&lt;&lt;</span> id5and7<span class="op">.</span>size<span class="op">()</span> <span class="op">&lt;&lt;</span> endl<span class="op">;</span></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span><span class="op">(</span><span class="kw">auto</span> <span class="op">&amp;</span>user <span class="op">:</span> id5and7<span class="op">)</span> <span class="op">{</span></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>    cout <span class="op">&lt;&lt;</span> storage<span class="op">.</span>dump<span class="op">(</span>user<span class="op">)</span> <span class="op">&lt;&lt;</span> endl<span class="op">;</span></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<p>Or let’s just export two users with id 10 or id 16 (of course if
these users exist):</p>
<div class="sourceCode" id="cb18"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="kw">auto</span> id10or16 <span class="op">=</span> storage<span class="op">.</span>get_all<span class="op">&lt;</span>User<span class="op">&gt;(</span>where<span class="op">(</span>c<span class="op">(&amp;</span>User<span class="op">::</span>id<span class="op">)</span> <span class="op">==</span> <span class="dv">10</span> <span class="kw">or</span> c<span class="op">(&amp;</span>User<span class="op">::</span>id<span class="op">)</span> <span class="op">==</span> <span class="dv">16</span><span class="op">));</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>cout <span class="op">&lt;&lt;</span> <span class="st">&quot;id10or16 count = &quot;</span> <span class="op">&lt;&lt;</span> id10or16<span class="op">.</span>size<span class="op">()</span> <span class="op">&lt;&lt;</span> endl<span class="op">;</span></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span><span class="op">(</span><span class="kw">auto</span> <span class="op">&amp;</span>user <span class="op">:</span> id10or16<span class="op">)</span> <span class="op">{</span></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>    cout <span class="op">&lt;&lt;</span> storage<span class="op">.</span>dump<span class="op">(</span>user<span class="op">)</span> <span class="op">&lt;&lt;</span> endl<span class="op">;</span></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<p>In fact you can chain together any number of different conditions
with any operator from <code>and</code>, <code>or</code> and
<code>not</code>. All conditions are templated so there is no runtime
overhead. And this makes <code>sqlite_orm</code> the most powerful
<strong>sqlite</strong> C++ ORM library!</p>
<p>Moreover you can use parentheses to set the priority of query
conditions:</p>
<div class="sourceCode" id="cb19"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="kw">auto</span> cuteConditions <span class="op">=</span> storage<span class="op">.</span>get_all<span class="op">&lt;</span>User<span class="op">&gt;(</span>where<span class="op">((</span>c<span class="op">(&amp;</span>User<span class="op">::</span>firstName<span class="op">)</span> <span class="op">==</span> <span class="st">&quot;John&quot;</span> <span class="kw">or</span> c<span class="op">(&amp;</span>User<span class="op">::</span>firstName<span class="op">)</span> <span class="op">==</span> <span class="st">&quot;Alex&quot;</span><span class="op">)</span> <span class="kw">and</span> c<span class="op">(&amp;</span>User<span class="op">::</span>id<span class="op">)</span> <span class="op">==</span> <span class="dv">4</span><span class="op">));</span>  <span class="co">//  where (first_name = &#39;John&#39; or first_name = &#39;Alex&#39;) and id = 4</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>cout <span class="op">&lt;&lt;</span> <span class="st">&quot;cuteConditions count = &quot;</span> <span class="op">&lt;&lt;</span> cuteConditions<span class="op">.</span>size<span class="op">()</span> <span class="op">&lt;&lt;</span> endl<span class="op">;</span> <span class="co">//  cuteConditions count = 1</span></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>cuteConditions <span class="op">=</span> storage<span class="op">.</span>get_all<span class="op">&lt;</span>User<span class="op">&gt;(</span>where<span class="op">(</span>c<span class="op">(&amp;</span>User<span class="op">::</span>firstName<span class="op">)</span> <span class="op">==</span> <span class="st">&quot;John&quot;</span> <span class="kw">or</span> <span class="op">(</span>c<span class="op">(&amp;</span>User<span class="op">::</span>firstName<span class="op">)</span> <span class="op">==</span> <span class="st">&quot;Alex&quot;</span> <span class="kw">and</span> c<span class="op">(&amp;</span>User<span class="op">::</span>id<span class="op">)</span> <span class="op">==</span> <span class="dv">4</span><span class="op">)));</span>   <span class="co">//  where first_name = &#39;John&#39; or (first_name = &#39;Alex&#39; and id = 4)</span></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>cout <span class="op">&lt;&lt;</span> <span class="st">&quot;cuteConditions count = &quot;</span> <span class="op">&lt;&lt;</span> cuteConditions<span class="op">.</span>size<span class="op">()</span> <span class="op">&lt;&lt;</span> endl<span class="op">;</span> <span class="co">//  cuteConditions count = 2</span></span></code></pre></div>
<p>Also we can implement <code>get</code> by id with
<code>get_all</code> and <code>where</code> like this:</p>
<div class="sourceCode" id="cb20"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co">//  SELECT * FROM users WHERE ( 2 = id )</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a><span class="kw">auto</span> idEquals2 <span class="op">=</span> storage<span class="op">.</span>get_all<span class="op">&lt;</span>User<span class="op">&gt;(</span>where<span class="op">(</span><span class="dv">2</span> <span class="op">==</span> c<span class="op">(&amp;</span>User<span class="op">::</span>id<span class="op">)));</span></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>cout <span class="op">&lt;&lt;</span> <span class="st">&quot;idEquals2 count = &quot;</span> <span class="op">&lt;&lt;</span> idEquals2<span class="op">.</span>size<span class="op">()</span> <span class="op">&lt;&lt;</span> endl<span class="op">;</span></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span><span class="op">(</span>idEquals2<span class="op">.</span>size<span class="op">()){</span></span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>    cout <span class="op">&lt;&lt;</span> storage<span class="op">.</span>dump<span class="op">(</span>idEquals2<span class="op">.</span>front<span class="op">())</span> <span class="op">&lt;&lt;</span> endl<span class="op">;</span></span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a><span class="op">}</span><span class="cf">else</span><span class="op">{</span></span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>    cout <span class="op">&lt;&lt;</span> <span class="st">&quot;user with id 2 doesn&#39;t exist&quot;</span> <span class="op">&lt;&lt;</span> endl<span class="op">;</span></span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<p>Lets try the <code>IN</code> operator:</p>
<div class="sourceCode" id="cb21"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co">//  SELECT * FROM users WHERE id IN (2, 4, 6, 8, 10)</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="kw">auto</span> evenLesserTen10 <span class="op">=</span> storage<span class="op">.</span>get_all<span class="op">&lt;</span>User<span class="op">&gt;(</span>where<span class="op">(</span>in<span class="op">(&amp;</span>User<span class="op">::</span>id<span class="op">,</span> <span class="op">{</span><span class="dv">2</span><span class="op">,</span> <span class="dv">4</span><span class="op">,</span> <span class="dv">6</span><span class="op">,</span> <span class="dv">8</span><span class="op">,</span> <span class="dv">10</span><span class="op">})));</span></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>cout <span class="op">&lt;&lt;</span> <span class="st">&quot;evenLesserTen10 count = &quot;</span> <span class="op">&lt;&lt;</span> evenLesserTen10<span class="op">.</span>size<span class="op">()</span> <span class="op">&lt;&lt;</span> endl<span class="op">;</span></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span><span class="op">(</span><span class="kw">auto</span> <span class="op">&amp;</span>user <span class="op">:</span> evenLesserTen10<span class="op">)</span> <span class="op">{</span></span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>    cout <span class="op">&lt;&lt;</span> storage<span class="op">.</span>dump<span class="op">(</span>user<span class="op">)</span> <span class="op">&lt;&lt;</span> endl<span class="op">;</span></span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a><span class="co">//  SELECT * FROM users WHERE last_name IN (&quot;Doe&quot;, &quot;White&quot;)</span></span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a><span class="kw">auto</span> doesAndWhites <span class="op">=</span> storage<span class="op">.</span>get_all<span class="op">&lt;</span>User<span class="op">&gt;(</span>where<span class="op">(</span>in<span class="op">(&amp;</span>User<span class="op">::</span>lastName<span class="op">,</span> <span class="op">{</span><span class="st">&quot;Doe&quot;</span><span class="op">,</span> <span class="st">&quot;White&quot;</span><span class="op">})));</span></span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a>cout <span class="op">&lt;&lt;</span> <span class="st">&quot;doesAndWhites count = &quot;</span> <span class="op">&lt;&lt;</span> doesAndWhites<span class="op">.</span>size<span class="op">()</span> <span class="op">&lt;&lt;</span> endl<span class="op">;</span></span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span><span class="op">(</span><span class="kw">auto</span> <span class="op">&amp;</span>user <span class="op">:</span> doesAndWhites<span class="op">)</span> <span class="op">{</span></span>
<span id="cb21-12"><a href="#cb21-12" aria-hidden="true" tabindex="-1"></a>    cout <span class="op">&lt;&lt;</span> storage<span class="op">.</span>dump<span class="op">(</span>user<span class="op">)</span> <span class="op">&lt;&lt;</span> endl<span class="op">;</span></span>
<span id="cb21-13"><a href="#cb21-13" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<p>And <code>BETWEEN</code>:</p>
<div class="sourceCode" id="cb22"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co">//  SELECT * FROM users WHERE id BETWEEN 66 AND 68</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a><span class="kw">auto</span> betweenId <span class="op">=</span> storage<span class="op">.</span>get_all<span class="op">&lt;</span>User<span class="op">&gt;(</span>where<span class="op">(</span>between<span class="op">(&amp;</span>User<span class="op">::</span>id<span class="op">,</span> <span class="dv">66</span><span class="op">,</span> <span class="dv">68</span><span class="op">)));</span></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>cout <span class="op">&lt;&lt;</span> <span class="st">&quot;betweenId = &quot;</span> <span class="op">&lt;&lt;</span> betweenId<span class="op">.</span>size<span class="op">()</span> <span class="op">&lt;&lt;</span> endl<span class="op">;</span></span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span><span class="op">(</span><span class="kw">auto</span> <span class="op">&amp;</span>user <span class="op">:</span> betweenId<span class="op">)</span> <span class="op">{</span></span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>    cout <span class="op">&lt;&lt;</span> storage<span class="op">.</span>dump<span class="op">(</span>user<span class="op">)</span> <span class="op">&lt;&lt;</span> endl<span class="op">;</span></span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<p>And even <code>LIKE</code>:</p>
<div class="sourceCode" id="cb23"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="co">//  SELECT * FROM users WHERE last_name LIKE &#39;D%&#39;</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a><span class="kw">auto</span> whereNameLike <span class="op">=</span> storage<span class="op">.</span>get_all<span class="op">&lt;</span>User<span class="op">&gt;(</span>where<span class="op">(</span>like<span class="op">(&amp;</span>User<span class="op">::</span>lastName<span class="op">,</span> <span class="st">&quot;D%&quot;</span><span class="op">)));</span></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>cout <span class="op">&lt;&lt;</span> <span class="st">&quot;whereNameLike = &quot;</span> <span class="op">&lt;&lt;</span> whereNameLike<span class="op">.</span>size<span class="op">()</span> <span class="op">&lt;&lt;</span> endl<span class="op">;</span></span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span><span class="op">(</span><span class="kw">auto</span> <span class="op">&amp;</span>user <span class="op">:</span> whereNameLike<span class="op">)</span> <span class="op">{</span></span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>    cout <span class="op">&lt;&lt;</span> storage<span class="op">.</span>dump<span class="op">(</span>user<span class="op">)</span> <span class="op">&lt;&lt;</span> endl<span class="op">;</span></span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<p>Looks like magic but it works very simple. Cute function
<code>c</code> (column) takes a class member pointer and returns a
special expression middle object that can be used with operators
overloaded in <code>::sqlite_orm</code> namespace. Operator overloads
act just like functions</p>
<ul>
<li>is_equal</li>
<li>is_not_equal</li>
<li>greater_than</li>
<li>greater_or_equal</li>
<li>lesser_than</li>
<li>lesser_or_equal</li>
<li>is_null</li>
<li>is_not_null</li>
</ul>
<p>that simulate binary comparison operator so they take 2 arguments:
left hand side and right hand side. Arguments may be either member
pointer of mapped class or any other expression (core/aggregate
function, literal or subexpression). Binary comparison functions map
arguments to text to be passed to sqlite engine to process query. Member
pointers are being mapped to column names and
literals/variables/constants to ‘?’ and then are bound automatically.
Next <code>where</code> function places brackets around condition and
adds “WHERE” keyword before condition text. Next resulted string appends
to a query string and is being processed further.</p>
<p>If you omit <code>where</code> function in <code>get_all</code> it
will return all objects from a table:</p>
<div class="sourceCode" id="cb24"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="kw">auto</span> allUsers <span class="op">=</span> storage<span class="op">.</span>get_all<span class="op">&lt;</span>User<span class="op">&gt;();</span></span></code></pre></div>
<p>Also you can use <code>remove_all</code> function to perform
<code>DELETE FROM ... WHERE</code> query with the same type of
conditions.</p>
<div class="sourceCode" id="cb25"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>storage<span class="op">.</span>remove_all<span class="op">&lt;</span>User<span class="op">&gt;(</span>where<span class="op">(</span>c<span class="op">(&amp;</span>User<span class="op">::</span>id<span class="op">)</span> <span class="op">&lt;</span> <span class="dv">100</span><span class="op">));</span></span></code></pre></div>
<h1 id="raw-select">Raw select</h1>
<p>If you need to extract only a single column
(<code>SELECT %column_name% FROM %table_name% WHERE %conditions%</code>)
you can use a non-CRUD <code>select</code> function:</p>
<div class="sourceCode" id="cb26"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a><span class="co">//  SELECT id FROM users</span></span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a><span class="kw">auto</span> allIds <span class="op">=</span> storage<span class="op">.</span>select<span class="op">(&amp;</span>User<span class="op">::</span>id<span class="op">);</span>    </span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>cout <span class="op">&lt;&lt;</span> <span class="st">&quot;allIds count = &quot;</span> <span class="op">&lt;&lt;</span> allIds<span class="op">.</span>size<span class="op">()</span> <span class="op">&lt;&lt;</span> endl<span class="op">;</span> <span class="co">//  allIds is std::vector&lt;int&gt;</span></span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span><span class="op">(</span><span class="kw">auto</span> <span class="op">&amp;</span>id <span class="op">:</span> allIds<span class="op">)</span> <span class="op">{</span></span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a>    cout <span class="op">&lt;&lt;</span> id <span class="op">&lt;&lt;</span> <span class="st">&quot; &quot;</span><span class="op">;</span></span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a>cout <span class="op">&lt;&lt;</span> endl<span class="op">;</span></span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-10"><a href="#cb26-10" aria-hidden="true" tabindex="-1"></a><span class="co">//  SELECT id FROM users WHERE last_name = &#39;Doe&#39;</span></span>
<span id="cb26-11"><a href="#cb26-11" aria-hidden="true" tabindex="-1"></a><span class="kw">auto</span> doeIds <span class="op">=</span> storage<span class="op">.</span>select<span class="op">(&amp;</span>User<span class="op">::</span>id<span class="op">,</span> where<span class="op">(</span>c<span class="op">(&amp;</span>User<span class="op">::</span>lastName<span class="op">)</span> <span class="op">==</span> <span class="st">&quot;Doe&quot;</span><span class="op">));</span></span>
<span id="cb26-12"><a href="#cb26-12" aria-hidden="true" tabindex="-1"></a>cout <span class="op">&lt;&lt;</span> <span class="st">&quot;doeIds count = &quot;</span> <span class="op">&lt;&lt;</span> doeIds<span class="op">.</span>size<span class="op">()</span> <span class="op">&lt;&lt;</span> endl<span class="op">;</span> <span class="co">//  doeIds is std::vector&lt;int&gt;</span></span>
<span id="cb26-13"><a href="#cb26-13" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span><span class="op">(</span><span class="kw">auto</span> <span class="op">&amp;</span>doeId <span class="op">:</span> doeIds<span class="op">)</span> <span class="op">{</span></span>
<span id="cb26-14"><a href="#cb26-14" aria-hidden="true" tabindex="-1"></a>    cout <span class="op">&lt;&lt;</span> doeId <span class="op">&lt;&lt;</span> <span class="st">&quot; &quot;</span><span class="op">;</span></span>
<span id="cb26-15"><a href="#cb26-15" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb26-16"><a href="#cb26-16" aria-hidden="true" tabindex="-1"></a>cout <span class="op">&lt;&lt;</span> endl<span class="op">;</span></span>
<span id="cb26-17"><a href="#cb26-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-18"><a href="#cb26-18" aria-hidden="true" tabindex="-1"></a><span class="co">//  SELECT last_name FROM users WHERE id &lt; 300</span></span>
<span id="cb26-19"><a href="#cb26-19" aria-hidden="true" tabindex="-1"></a><span class="kw">auto</span> allLastNames <span class="op">=</span> storage<span class="op">.</span>select<span class="op">(&amp;</span>User<span class="op">::</span>lastName<span class="op">,</span> where<span class="op">(</span>c<span class="op">(&amp;</span>User<span class="op">::</span>id<span class="op">)</span> <span class="op">&lt;</span> <span class="dv">300</span><span class="op">));</span>    </span>
<span id="cb26-20"><a href="#cb26-20" aria-hidden="true" tabindex="-1"></a>cout <span class="op">&lt;&lt;</span> <span class="st">&quot;allLastNames count = &quot;</span> <span class="op">&lt;&lt;</span> allLastNames<span class="op">.</span>size<span class="op">()</span> <span class="op">&lt;&lt;</span> endl<span class="op">;</span> <span class="co">//  allLastNames is std::vector&lt;std::string&gt;</span></span>
<span id="cb26-21"><a href="#cb26-21" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span><span class="op">(</span><span class="kw">auto</span> <span class="op">&amp;</span>lastName <span class="op">:</span> allLastNames<span class="op">)</span> <span class="op">{</span></span>
<span id="cb26-22"><a href="#cb26-22" aria-hidden="true" tabindex="-1"></a>    cout <span class="op">&lt;&lt;</span> lastName <span class="op">&lt;&lt;</span> <span class="st">&quot; &quot;</span><span class="op">;</span></span>
<span id="cb26-23"><a href="#cb26-23" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb26-24"><a href="#cb26-24" aria-hidden="true" tabindex="-1"></a>cout <span class="op">&lt;&lt;</span> endl<span class="op">;</span></span>
<span id="cb26-25"><a href="#cb26-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-26"><a href="#cb26-26" aria-hidden="true" tabindex="-1"></a><span class="co">//  SELECT id FROM users WHERE image_url IS NULL</span></span>
<span id="cb26-27"><a href="#cb26-27" aria-hidden="true" tabindex="-1"></a><span class="kw">auto</span> idsWithoutUrls <span class="op">=</span> storage<span class="op">.</span>select<span class="op">(&amp;</span>User<span class="op">::</span>id<span class="op">,</span> where<span class="op">(</span>is_null<span class="op">(&amp;</span>User<span class="op">::</span>imageUrl<span class="op">)));</span></span>
<span id="cb26-28"><a href="#cb26-28" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span><span class="op">(</span><span class="kw">auto</span> id <span class="op">:</span> idsWithoutUrls<span class="op">)</span> <span class="op">{</span></span>
<span id="cb26-29"><a href="#cb26-29" aria-hidden="true" tabindex="-1"></a>    cout <span class="op">&lt;&lt;</span> <span class="st">&quot;id without image url &quot;</span> <span class="op">&lt;&lt;</span> id <span class="op">&lt;&lt;</span> endl<span class="op">;</span></span>
<span id="cb26-30"><a href="#cb26-30" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb26-31"><a href="#cb26-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-32"><a href="#cb26-32" aria-hidden="true" tabindex="-1"></a><span class="co">//  SELECT id FROM users WHERE image_url IS NOT NULL</span></span>
<span id="cb26-33"><a href="#cb26-33" aria-hidden="true" tabindex="-1"></a><span class="kw">auto</span> idsWithUrl <span class="op">=</span> storage<span class="op">.</span>select<span class="op">(&amp;</span>User<span class="op">::</span>id<span class="op">,</span> where<span class="op">(</span>is_not_null<span class="op">(&amp;</span>User<span class="op">::</span>imageUrl<span class="op">)));</span></span>
<span id="cb26-34"><a href="#cb26-34" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span><span class="op">(</span><span class="kw">auto</span> id <span class="op">:</span> idsWithUrl<span class="op">)</span> <span class="op">{</span></span>
<span id="cb26-35"><a href="#cb26-35" aria-hidden="true" tabindex="-1"></a>    cout <span class="op">&lt;&lt;</span> <span class="st">&quot;id with image url &quot;</span> <span class="op">&lt;&lt;</span> id <span class="op">&lt;&lt;</span> endl<span class="op">;</span></span>
<span id="cb26-36"><a href="#cb26-36" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb26-37"><a href="#cb26-37" aria-hidden="true" tabindex="-1"></a><span class="kw">auto</span> idsWithUrl2 <span class="op">=</span> storage<span class="op">.</span>select<span class="op">(&amp;</span>User<span class="op">::</span>id<span class="op">,</span> where<span class="op">(</span><span class="kw">not</span> is_null<span class="op">(&amp;</span>User<span class="op">::</span>imageUrl<span class="op">)));</span></span>
<span id="cb26-38"><a href="#cb26-38" aria-hidden="true" tabindex="-1"></a><span class="ot">assert</span><span class="op">(</span><span class="bu">std::</span>equal<span class="op">(</span>idsWithUrl2<span class="op">.</span>begin<span class="op">(),</span></span>
<span id="cb26-39"><a href="#cb26-39" aria-hidden="true" tabindex="-1"></a>                  idsWithUrl2<span class="op">.</span>end<span class="op">(),</span></span>
<span id="cb26-40"><a href="#cb26-40" aria-hidden="true" tabindex="-1"></a>                  idsWithUrl<span class="op">.</span>begin<span class="op">()));</span></span></code></pre></div>
<p>Also you’re able to select several column in a vector of tuples.
Example:</p>
<div class="sourceCode" id="cb27"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="co">//  `SELECT first_name, last_name FROM users WHERE id &gt; 250 ORDER BY id`</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a><span class="kw">auto</span> partialSelect <span class="op">=</span> storage<span class="op">.</span>select<span class="op">(</span>columns<span class="op">(&amp;</span>User<span class="op">::</span>firstName<span class="op">,</span> <span class="op">&amp;</span>User<span class="op">::</span>lastName<span class="op">),</span></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>                                    where<span class="op">(</span>c<span class="op">(&amp;</span>User<span class="op">::</span>id<span class="op">)</span> <span class="op">&gt;</span> <span class="dv">250</span><span class="op">),</span></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>                                    order_by<span class="op">(&amp;</span>User<span class="op">::</span>id<span class="op">));</span></span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>cout <span class="op">&lt;&lt;</span> <span class="st">&quot;partialSelect count = &quot;</span> <span class="op">&lt;&lt;</span> partialSelect<span class="op">.</span>size<span class="op">()</span> <span class="op">&lt;&lt;</span> endl<span class="op">;</span></span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span><span class="op">(</span><span class="kw">auto</span> <span class="op">&amp;</span>t <span class="op">:</span> partialSelect<span class="op">)</span> <span class="op">{</span></span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a>    <span class="kw">auto</span> <span class="op">&amp;</span>firstName <span class="op">=</span> <span class="bu">std::</span>get<span class="op">&lt;</span><span class="dv">0</span><span class="op">&gt;(</span>t<span class="op">);</span></span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a>    <span class="kw">auto</span> <span class="op">&amp;</span>lastName <span class="op">=</span> <span class="bu">std::</span>get<span class="op">&lt;</span><span class="dv">1</span><span class="op">&gt;(</span>t<span class="op">);</span></span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a>    cout <span class="op">&lt;&lt;</span> firstName <span class="op">&lt;&lt;</span> <span class="st">&quot; &quot;</span> <span class="op">&lt;&lt;</span> lastName <span class="op">&lt;&lt;</span> endl<span class="op">;</span></span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<h1 id="order-by-support">ORDER BY support</h1>
<p>ORDER BY query option can be applied to <code>get_all</code> and
<code>select</code> functions just like <code>where</code> but with
<code>order_by</code> function. It can be mixed with WHERE in a single
query. Examples:</p>
<div class="sourceCode" id="cb28"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="co">//  `SELECT * FROM users ORDER BY id`</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a><span class="kw">auto</span> orderedUsers <span class="op">=</span> storage<span class="op">.</span>get_all<span class="op">&lt;</span>User<span class="op">&gt;(</span>order_by<span class="op">(&amp;</span>User<span class="op">::</span>id<span class="op">));</span></span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>cout <span class="op">&lt;&lt;</span> <span class="st">&quot;orderedUsers count = &quot;</span> <span class="op">&lt;&lt;</span> orderedUsers<span class="op">.</span>size<span class="op">()</span> <span class="op">&lt;&lt;</span> endl<span class="op">;</span></span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span><span class="op">(</span><span class="kw">auto</span> <span class="op">&amp;</span>user <span class="op">:</span> orderedUsers<span class="op">)</span> <span class="op">{</span></span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>    cout <span class="op">&lt;&lt;</span> storage<span class="op">.</span>dump<span class="op">(</span>user<span class="op">)</span> <span class="op">&lt;&lt;</span> endl<span class="op">;</span></span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a><span class="co">//  `SELECT * FROM users WHERE id &lt; 250 ORDER BY first_name`</span></span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a><span class="kw">auto</span> orderedUsers2 <span class="op">=</span> storage<span class="op">.</span>get_all<span class="op">&lt;</span>User<span class="op">&gt;(</span>where<span class="op">(</span>c<span class="op">(&amp;</span>User<span class="op">::</span>id<span class="op">)</span> <span class="op">&lt;</span> <span class="dv">250</span><span class="op">),</span> order_by<span class="op">(&amp;</span>User<span class="op">::</span>firstName<span class="op">));</span></span>
<span id="cb28-10"><a href="#cb28-10" aria-hidden="true" tabindex="-1"></a>cout <span class="op">&lt;&lt;</span> <span class="st">&quot;orderedUsers2 count = &quot;</span> <span class="op">&lt;&lt;</span> orderedUsers2<span class="op">.</span>size<span class="op">()</span> <span class="op">&lt;&lt;</span> endl<span class="op">;</span></span>
<span id="cb28-11"><a href="#cb28-11" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span><span class="op">(</span><span class="kw">auto</span> <span class="op">&amp;</span>user <span class="op">:</span> orderedUsers2<span class="op">)</span> <span class="op">{</span></span>
<span id="cb28-12"><a href="#cb28-12" aria-hidden="true" tabindex="-1"></a>    cout <span class="op">&lt;&lt;</span> storage<span class="op">.</span>dump<span class="op">(</span>user<span class="op">)</span> <span class="op">&lt;&lt;</span> endl<span class="op">;</span></span>
<span id="cb28-13"><a href="#cb28-13" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb28-14"><a href="#cb28-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-15"><a href="#cb28-15" aria-hidden="true" tabindex="-1"></a><span class="co">//  `SELECT * FROM users WHERE id &gt; 100 ORDER BY first_name ASC`</span></span>
<span id="cb28-16"><a href="#cb28-16" aria-hidden="true" tabindex="-1"></a><span class="kw">auto</span> orderedUsers3 <span class="op">=</span> storage<span class="op">.</span>get_all<span class="op">&lt;</span>User<span class="op">&gt;(</span>where<span class="op">(</span>c<span class="op">(&amp;</span>User<span class="op">::</span>id<span class="op">)</span> <span class="op">&gt;</span> <span class="dv">100</span><span class="op">),</span> order_by<span class="op">(&amp;</span>User<span class="op">::</span>firstName<span class="op">).</span>asc<span class="op">());</span></span>
<span id="cb28-17"><a href="#cb28-17" aria-hidden="true" tabindex="-1"></a>cout <span class="op">&lt;&lt;</span> <span class="st">&quot;orderedUsers3 count = &quot;</span> <span class="op">&lt;&lt;</span> orderedUsers3<span class="op">.</span>size<span class="op">()</span> <span class="op">&lt;&lt;</span> endl<span class="op">;</span></span>
<span id="cb28-18"><a href="#cb28-18" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span><span class="op">(</span><span class="kw">auto</span> <span class="op">&amp;</span>user <span class="op">:</span> orderedUsers3<span class="op">)</span> <span class="op">{</span></span>
<span id="cb28-19"><a href="#cb28-19" aria-hidden="true" tabindex="-1"></a>    cout <span class="op">&lt;&lt;</span> storage<span class="op">.</span>dump<span class="op">(</span>user<span class="op">)</span> <span class="op">&lt;&lt;</span> endl<span class="op">;</span></span>
<span id="cb28-20"><a href="#cb28-20" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb28-21"><a href="#cb28-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-22"><a href="#cb28-22" aria-hidden="true" tabindex="-1"></a><span class="co">//  `SELECT * FROM users ORDER BY id DESC`</span></span>
<span id="cb28-23"><a href="#cb28-23" aria-hidden="true" tabindex="-1"></a><span class="kw">auto</span> orderedUsers4 <span class="op">=</span> storage<span class="op">.</span>get_all<span class="op">&lt;</span>User<span class="op">&gt;(</span>order_by<span class="op">(&amp;</span>User<span class="op">::</span>id<span class="op">).</span>desc<span class="op">());</span></span>
<span id="cb28-24"><a href="#cb28-24" aria-hidden="true" tabindex="-1"></a>cout <span class="op">&lt;&lt;</span> <span class="st">&quot;orderedUsers4 count = &quot;</span> <span class="op">&lt;&lt;</span> orderedUsers4<span class="op">.</span>size<span class="op">()</span> <span class="op">&lt;&lt;</span> endl<span class="op">;</span></span>
<span id="cb28-25"><a href="#cb28-25" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span><span class="op">(</span><span class="kw">auto</span> <span class="op">&amp;</span>user <span class="op">:</span> orderedUsers4<span class="op">)</span> <span class="op">{</span></span>
<span id="cb28-26"><a href="#cb28-26" aria-hidden="true" tabindex="-1"></a>    cout <span class="op">&lt;&lt;</span> storage<span class="op">.</span>dump<span class="op">(</span>user<span class="op">)</span> <span class="op">&lt;&lt;</span> endl<span class="op">;</span></span>
<span id="cb28-27"><a href="#cb28-27" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb28-28"><a href="#cb28-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-29"><a href="#cb28-29" aria-hidden="true" tabindex="-1"></a><span class="co">//  `SELECT first_name FROM users ORDER BY ID DESC`</span></span>
<span id="cb28-30"><a href="#cb28-30" aria-hidden="true" tabindex="-1"></a><span class="kw">auto</span> orderedFirstNames <span class="op">=</span> storage<span class="op">.</span>select<span class="op">(&amp;</span>User<span class="op">::</span>firstName<span class="op">,</span> order_by<span class="op">(&amp;</span>User<span class="op">::</span>id<span class="op">).</span>desc<span class="op">());</span></span>
<span id="cb28-31"><a href="#cb28-31" aria-hidden="true" tabindex="-1"></a>cout <span class="op">&lt;&lt;</span> <span class="st">&quot;orderedFirstNames count = &quot;</span> <span class="op">&lt;&lt;</span> orderedFirstNames<span class="op">.</span>size<span class="op">()</span> <span class="op">&lt;&lt;</span> endl<span class="op">;</span></span>
<span id="cb28-32"><a href="#cb28-32" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span><span class="op">(</span><span class="kw">auto</span> <span class="op">&amp;</span>firstName <span class="op">:</span> orderedFirstNames<span class="op">)</span> <span class="op">{</span></span>
<span id="cb28-33"><a href="#cb28-33" aria-hidden="true" tabindex="-1"></a>    cout <span class="op">&lt;&lt;</span> <span class="st">&quot;firstName = &quot;</span> <span class="op">&lt;&lt;</span> firstName <span class="op">&lt;&lt;</span> endl<span class="op">;</span></span>
<span id="cb28-34"><a href="#cb28-34" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<h1 id="limit-and-offset">LIMIT and OFFSET</h1>
<p>There are three available versions of
<code>LIMIT</code>/<code>OFFSET</code> options:</p>
<ul>
<li>LIMIT %limit%</li>
<li>LIMIT %limit% OFFSET %offset%</li>
<li>LIMIT %offset%, %limit%</li>
</ul>
<p>All these versions available with the same interface:</p>
<div class="sourceCode" id="cb29"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="co">//  `SELECT * FROM users WHERE id &gt; 250 ORDER BY id LIMIT 5`</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a><span class="kw">auto</span> limited5 <span class="op">=</span> storage<span class="op">.</span>get_all<span class="op">&lt;</span>User<span class="op">&gt;(</span>where<span class="op">(</span>c<span class="op">(&amp;</span>User<span class="op">::</span>id<span class="op">)</span> <span class="op">&gt;</span> <span class="dv">250</span><span class="op">),</span></span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>                                      order_by<span class="op">(&amp;</span>User<span class="op">::</span>id<span class="op">),</span></span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>                                      limit<span class="op">(</span><span class="dv">5</span><span class="op">));</span></span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>cout <span class="op">&lt;&lt;</span> <span class="st">&quot;limited5 count = &quot;</span> <span class="op">&lt;&lt;</span> limited5<span class="op">.</span>size<span class="op">()</span> <span class="op">&lt;&lt;</span> endl<span class="op">;</span></span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span><span class="op">(</span><span class="kw">auto</span> <span class="op">&amp;</span>user <span class="op">:</span> limited5<span class="op">)</span> <span class="op">{</span></span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a>    cout <span class="op">&lt;&lt;</span> storage<span class="op">.</span>dump<span class="op">(</span>user<span class="op">)</span> <span class="op">&lt;&lt;</span> endl<span class="op">;</span></span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-10"><a href="#cb29-10" aria-hidden="true" tabindex="-1"></a><span class="co">//  `SELECT * FROM users WHERE id &gt; 250 ORDER BY id LIMIT 5, 10`</span></span>
<span id="cb29-11"><a href="#cb29-11" aria-hidden="true" tabindex="-1"></a><span class="kw">auto</span> limited5comma10 <span class="op">=</span> storage<span class="op">.</span>get_all<span class="op">&lt;</span>User<span class="op">&gt;(</span>where<span class="op">(</span>c<span class="op">(&amp;</span>User<span class="op">::</span>id<span class="op">)</span> <span class="op">&gt;</span> <span class="dv">250</span><span class="op">),</span></span>
<span id="cb29-12"><a href="#cb29-12" aria-hidden="true" tabindex="-1"></a>                                             order_by<span class="op">(&amp;</span>User<span class="op">::</span>id<span class="op">),</span></span>
<span id="cb29-13"><a href="#cb29-13" aria-hidden="true" tabindex="-1"></a>                                             limit<span class="op">(</span><span class="dv">5</span><span class="op">,</span> <span class="dv">10</span><span class="op">));</span></span>
<span id="cb29-14"><a href="#cb29-14" aria-hidden="true" tabindex="-1"></a>cout <span class="op">&lt;&lt;</span> <span class="st">&quot;limited5comma10 count = &quot;</span> <span class="op">&lt;&lt;</span> limited5comma10<span class="op">.</span>size<span class="op">()</span> <span class="op">&lt;&lt;</span> endl<span class="op">;</span></span>
<span id="cb29-15"><a href="#cb29-15" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span><span class="op">(</span><span class="kw">auto</span> <span class="op">&amp;</span>user <span class="op">:</span> limited5comma10<span class="op">)</span> <span class="op">{</span></span>
<span id="cb29-16"><a href="#cb29-16" aria-hidden="true" tabindex="-1"></a>    cout <span class="op">&lt;&lt;</span> storage<span class="op">.</span>dump<span class="op">(</span>user<span class="op">)</span> <span class="op">&lt;&lt;</span> endl<span class="op">;</span></span>
<span id="cb29-17"><a href="#cb29-17" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb29-18"><a href="#cb29-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-19"><a href="#cb29-19" aria-hidden="true" tabindex="-1"></a><span class="co">//  `SELECT * FROM users WHERE id &gt; 250 ORDER BY id LIMIT 5 OFFSET 10`</span></span>
<span id="cb29-20"><a href="#cb29-20" aria-hidden="true" tabindex="-1"></a><span class="kw">auto</span> limit5offset10 <span class="op">=</span> storage<span class="op">.</span>get_all<span class="op">&lt;</span>User<span class="op">&gt;(</span>where<span class="op">(</span>c<span class="op">(&amp;</span>User<span class="op">::</span>id<span class="op">)</span> <span class="op">&gt;</span> <span class="dv">250</span><span class="op">),</span></span>
<span id="cb29-21"><a href="#cb29-21" aria-hidden="true" tabindex="-1"></a>                                            order_by<span class="op">(&amp;</span>User<span class="op">::</span>id<span class="op">),</span></span>
<span id="cb29-22"><a href="#cb29-22" aria-hidden="true" tabindex="-1"></a>                                            limit<span class="op">(</span><span class="dv">5</span><span class="op">,</span> offset<span class="op">(</span><span class="dv">10</span><span class="op">)));</span></span>
<span id="cb29-23"><a href="#cb29-23" aria-hidden="true" tabindex="-1"></a>cout <span class="op">&lt;&lt;</span> <span class="st">&quot;limit5offset10 count = &quot;</span> <span class="op">&lt;&lt;</span> limit5offset10<span class="op">.</span>size<span class="op">()</span> <span class="op">&lt;&lt;</span> endl<span class="op">;</span></span>
<span id="cb29-24"><a href="#cb29-24" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span><span class="op">(</span><span class="kw">auto</span> <span class="op">&amp;</span>user <span class="op">:</span> limit5offset10<span class="op">)</span> <span class="op">{</span></span>
<span id="cb29-25"><a href="#cb29-25" aria-hidden="true" tabindex="-1"></a>    cout <span class="op">&lt;&lt;</span> storage<span class="op">.</span>dump<span class="op">(</span>user<span class="op">)</span> <span class="op">&lt;&lt;</span> endl<span class="op">;</span></span>
<span id="cb29-26"><a href="#cb29-26" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<p>Please beware that queries <code>LIMIT 5, 10</code> and
<code>LIMIT 5 OFFSET 10</code> mean different. <code>LIMIT 5, 10</code>
means <code>LIMIT 10 OFFSET 5</code>.</p>
<h1 id="join-support">JOIN support</h1>
<p>You can perform simple <code>JOIN</code>, <code>CROSS JOIN</code>,
<code>INNER JOIN</code>, <code>LEFT JOIN</code> or
<code>LEFT OUTER JOIN</code> in your query. Instead of joined table
specify mapped type. Example for doctors and visits:</p>
<div class="sourceCode" id="cb30"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="co">//  SELECT a.doctor_id, a.doctor_name,</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a><span class="co">//      c.patient_name, c.vdate</span></span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a><span class="co">//  FROM doctors a</span></span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a><span class="co">//  LEFT JOIN visits c</span></span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a><span class="co">//  ON a.doctor_id=c.doctor_id;</span></span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a><span class="kw">auto</span> rows <span class="op">=</span> storage2<span class="op">.</span>select<span class="op">(</span>columns<span class="op">(&amp;</span>Doctor<span class="op">::</span>id<span class="op">,</span> <span class="op">&amp;</span>Doctor<span class="op">::</span>name<span class="op">,</span> <span class="op">&amp;</span>Visit<span class="op">::</span>patientName<span class="op">,</span> <span class="op">&amp;</span>Visit<span class="op">::</span>vdate<span class="op">),</span></span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a>                            left_join<span class="op">&lt;</span>Visit<span class="op">&gt;(</span>on<span class="op">(</span>c<span class="op">(&amp;</span>Doctor<span class="op">::</span>id<span class="op">)</span> <span class="op">==</span> <span class="op">&amp;</span>Visit<span class="op">::</span>doctorId<span class="op">)));</span>  <span class="co">//  one `c` call is enough cause operator overloads are templated</span></span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span><span class="op">(</span><span class="kw">auto</span> <span class="op">&amp;</span>row <span class="op">:</span> rows<span class="op">)</span> <span class="op">{</span></span>
<span id="cb30-9"><a href="#cb30-9" aria-hidden="true" tabindex="-1"></a>    cout <span class="op">&lt;&lt;</span> <span class="bu">std::</span>get<span class="op">&lt;</span><span class="dv">0</span><span class="op">&gt;(</span>row<span class="op">)</span> <span class="op">&lt;&lt;</span> <span class="ch">&#39;</span><span class="sc">\t</span><span class="ch">&#39;</span> <span class="op">&lt;&lt;</span> <span class="bu">std::</span>get<span class="op">&lt;</span><span class="dv">1</span><span class="op">&gt;(</span>row<span class="op">)</span> <span class="op">&lt;&lt;</span> <span class="ch">&#39;</span><span class="sc">\t</span><span class="ch">&#39;</span> <span class="op">&lt;&lt;</span> <span class="bu">std::</span>get<span class="op">&lt;</span><span class="dv">2</span><span class="op">&gt;(</span>row<span class="op">)</span> <span class="op">&lt;&lt;</span> <span class="ch">&#39;</span><span class="sc">\t</span><span class="ch">&#39;</span> <span class="op">&lt;&lt;</span> <span class="bu">std::</span>get<span class="op">&lt;</span><span class="dv">3</span><span class="op">&gt;(</span>row<span class="op">)</span> <span class="op">&lt;&lt;</span> endl<span class="op">;</span></span>
<span id="cb30-10"><a href="#cb30-10" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb30-11"><a href="#cb30-11" aria-hidden="true" tabindex="-1"></a>cout <span class="op">&lt;&lt;</span> endl<span class="op">;</span></span></code></pre></div>
<p>Simple <code>JOIN</code>:</p>
<div class="sourceCode" id="cb31"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="co">//  SELECT a.doctor_id,a.doctor_name,</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a><span class="co">//      c.patient_name,c.vdate</span></span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a><span class="co">//  FROM doctors a</span></span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a><span class="co">//  JOIN visits c</span></span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a><span class="co">//  ON a.doctor_id=c.doctor_id;</span></span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a>rows <span class="op">=</span> storage2<span class="op">.</span>select<span class="op">(</span>columns<span class="op">(&amp;</span>Doctor<span class="op">::</span>id<span class="op">,</span> <span class="op">&amp;</span>Doctor<span class="op">::</span>name<span class="op">,</span> <span class="op">&amp;</span>Visit<span class="op">::</span>patientName<span class="op">,</span> <span class="op">&amp;</span>Visit<span class="op">::</span>vdate<span class="op">),</span></span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a>                       join<span class="op">&lt;</span>Visit<span class="op">&gt;(</span>on<span class="op">(</span>c<span class="op">(&amp;</span>Doctor<span class="op">::</span>id<span class="op">)</span> <span class="op">==</span> <span class="op">&amp;</span>Visit<span class="op">::</span>doctorId<span class="op">)));</span></span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span><span class="op">(</span><span class="kw">auto</span> <span class="op">&amp;</span>row <span class="op">:</span> rows<span class="op">)</span> <span class="op">{</span></span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a>    cout <span class="op">&lt;&lt;</span> <span class="bu">std::</span>get<span class="op">&lt;</span><span class="dv">0</span><span class="op">&gt;(</span>row<span class="op">)</span> <span class="op">&lt;&lt;</span> <span class="ch">&#39;</span><span class="sc">\t</span><span class="ch">&#39;</span> <span class="op">&lt;&lt;</span> <span class="bu">std::</span>get<span class="op">&lt;</span><span class="dv">1</span><span class="op">&gt;(</span>row<span class="op">)</span> <span class="op">&lt;&lt;</span> <span class="ch">&#39;</span><span class="sc">\t</span><span class="ch">&#39;</span> <span class="op">&lt;&lt;</span> <span class="bu">std::</span>get<span class="op">&lt;</span><span class="dv">2</span><span class="op">&gt;(</span>row<span class="op">)</span> <span class="op">&lt;&lt;</span> <span class="ch">&#39;</span><span class="sc">\t</span><span class="ch">&#39;</span> <span class="op">&lt;&lt;</span> <span class="bu">std::</span>get<span class="op">&lt;</span><span class="dv">3</span><span class="op">&gt;(</span>row<span class="op">)</span> <span class="op">&lt;&lt;</span> endl<span class="op">;</span></span>
<span id="cb31-10"><a href="#cb31-10" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb31-11"><a href="#cb31-11" aria-hidden="true" tabindex="-1"></a>cout <span class="op">&lt;&lt;</span> endl<span class="op">;</span></span></code></pre></div>
<p>Two <code>INNER JOIN</code>s in one query:</p>
<div class="sourceCode" id="cb32"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="co">//  SELECT</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a><span class="co">//      trackid,</span></span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a><span class="co">//      tracks.name AS Track,</span></span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a><span class="co">//      albums.title AS Album,</span></span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a><span class="co">//      artists.name AS Artist</span></span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a><span class="co">//  FROM</span></span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a><span class="co">//      tracks</span></span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a><span class="co">//  INNER JOIN albums ON albums.albumid = tracks.albumid</span></span>
<span id="cb32-9"><a href="#cb32-9" aria-hidden="true" tabindex="-1"></a><span class="co">//  INNER JOIN artists ON artists.artistid = albums.artistid;</span></span>
<span id="cb32-10"><a href="#cb32-10" aria-hidden="true" tabindex="-1"></a><span class="kw">auto</span> innerJoinRows2 <span class="op">=</span> storage<span class="op">.</span>select<span class="op">(</span>columns<span class="op">(&amp;</span>Track<span class="op">::</span>trackId<span class="op">,</span> <span class="op">&amp;</span>Track<span class="op">::</span>name<span class="op">,</span> <span class="op">&amp;</span>Album<span class="op">::</span>title<span class="op">,</span> <span class="op">&amp;</span>Artist<span class="op">::</span>name<span class="op">),</span></span>
<span id="cb32-11"><a href="#cb32-11" aria-hidden="true" tabindex="-1"></a>                                     inner_join<span class="op">&lt;</span>Album<span class="op">&gt;(</span>on<span class="op">(</span>c<span class="op">(&amp;</span>Album<span class="op">::</span>albumId<span class="op">)</span> <span class="op">==</span> <span class="op">&amp;</span>Track<span class="op">::</span>albumId<span class="op">)),</span></span>
<span id="cb32-12"><a href="#cb32-12" aria-hidden="true" tabindex="-1"></a>                                     inner_join<span class="op">&lt;</span>Artist<span class="op">&gt;(</span>on<span class="op">(</span>c<span class="op">(&amp;</span>Artist<span class="op">::</span>artistId<span class="op">)</span> <span class="op">==</span> <span class="op">&amp;</span>Album<span class="op">::</span>artistId<span class="op">)));</span></span>
<span id="cb32-13"><a href="#cb32-13" aria-hidden="true" tabindex="-1"></a><span class="co">//  innerJoinRows2 is std::vector&lt;std::tuple&lt;decltype(Track::trackId), decltype(Track::name), decltype(Album::title), decltype(Artist::name)&gt;&gt;</span></span></code></pre></div>
<p>More join examples can be found in <a
href="https://github.com/fnc12/sqlite_orm/blob/master/examples/left_and_inner_join.cpp">examples
folder</a>.</p>
<h1 id="migrations-functionality">Migrations functionality</h1>
<p>There are no explicit <code>up</code> and <code>down</code> functions
that are used to be used in migrations. Instead <code>sqlite_orm</code>
offers <code>sync_schema</code> function that takes responsibility of
comparing actual db file schema with one you specified in
<code>make_storage</code> call and if something is not equal it alters
or drops/creates schema.</p>
<div class="sourceCode" id="cb33"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>storage<span class="op">.</span>sync_schema<span class="op">();</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a><span class="co">//  or</span></span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>storage<span class="op">.</span>sync_schema<span class="op">(</span><span class="kw">true</span><span class="op">);</span></span></code></pre></div>
<p>Please beware that <code>sync_schema</code> doesn’t guarantee that
data will be saved. It <em>tries</em> to save it only. Below you can see
rules list that <code>sync_schema</code> follows during call: * if there
are excess tables exist in db they are ignored (not dropped) * every
table from storage is compared with it’s db analog and * if table
doesn’t exist it is created * if table exists its colums are being
compared with table_info from db and * if there are columns in db that
do not exist in storage (excess) table will be dropped and recreated if
<code>preserve</code> is <code>false</code>, and table will be copied
into temporary table without excess columns, source table will be
dropped, copied table will be renamed to source table (sqlite remove
column technique) if <code>preserve</code> is <code>true</code>.
<code>preserve</code> is the first argument in <code>sync_schema</code>
function. It’s default value is <code>false</code>. Beware that setting
it to <code>true</code> may take time for copying table rows. * if there
are columns in storage that do not exist in db they will be added using
‘ALTER TABLE … ADD COLUMN …’ command and table data will not be dropped
but if any of added columns is null but has not default value table will
be dropped and recreated * if there is any column existing in both db
and storage but differs by any of properties (type, pk, notnull) table
will be dropped and recreated (dflt_value isn’t checked cause there can
be ambiguity in default values, please beware).</p>
<p>The best practice is to call this function right after storage
creation.</p>
<h1 id="transactions">Transactions</h1>
<p>There are three ways to begin and commit/rollback transactions: *
explicitly call <code>begin_transaction();</code>,
<code>rollback();</code> or <code>commit();</code> functions * use
<code>transaction</code> function which begins transaction implicitly
and takes a lambda argument which returns true for commit and false for
rollback. All storage calls performed in lambda can be commited or
rollbacked by returning <code>true</code> or <code>false</code>. * use
<code>transaction_guard</code> function which returns a guard object
which works just like <code>lock_guard</code> for
<code>std::mutex</code>.</p>
<p>Example for explicit call:</p>
<div class="sourceCode" id="cb34"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="kw">auto</span> secondUser <span class="op">=</span> storage<span class="op">.</span>get<span class="op">&lt;</span>User<span class="op">&gt;(</span><span class="dv">2</span><span class="op">);</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>storage<span class="op">.</span>begin_transaction<span class="op">();</span></span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>secondUser<span class="op">.</span>typeId <span class="op">=</span> <span class="dv">3</span><span class="op">;</span></span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a>storage<span class="op">.</span>update<span class="op">(</span>secondUser<span class="op">);</span></span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a>storage<span class="op">.</span>rollback<span class="op">();</span> <span class="co">//  or storage.commit();</span></span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a>secondUser <span class="op">=</span> storage<span class="op">.</span>get<span class="op">&lt;</span><span class="kw">decltype</span><span class="op">(</span>secondUser<span class="op">)&gt;(</span>secondUser<span class="op">.</span>id<span class="op">);</span></span>
<span id="cb34-9"><a href="#cb34-9" aria-hidden="true" tabindex="-1"></a><span class="ot">assert</span><span class="op">(</span>secondUser<span class="op">.</span>typeId <span class="op">!=</span> <span class="dv">3</span><span class="op">);</span></span></code></pre></div>
<p>Example for implicit call:</p>
<div class="sourceCode" id="cb35"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>storage<span class="op">.</span>transaction<span class="op">([&amp;]</span> <span class="op">()</span> <span class="at">mutable</span> <span class="op">{</span>    <span class="co">//  mutable keyword allows make non-const function calls</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>    <span class="kw">auto</span> secondUser <span class="op">=</span> storage<span class="op">.</span>get<span class="op">&lt;</span>User<span class="op">&gt;(</span><span class="dv">2</span><span class="op">);</span></span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>    secondUser<span class="op">.</span>typeId <span class="op">=</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>    storage<span class="op">.</span>update<span class="op">(</span>secondUser<span class="op">);</span></span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>    <span class="kw">auto</span> gottaRollback <span class="op">=</span> <span class="dt">bool</span><span class="op">(</span>rand<span class="op">()</span> <span class="op">%</span> <span class="dv">2</span><span class="op">);</span></span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span><span class="op">(</span>gottaRollback<span class="op">){</span>  <span class="co">//  dummy condition for test</span></span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="kw">false</span><span class="op">;</span>   <span class="co">//  exits lambda and calls ROLLBACK</span></span>
<span id="cb35-8"><a href="#cb35-8" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb35-9"><a href="#cb35-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="kw">true</span><span class="op">;</span>        <span class="co">//  exits lambda and calls COMMIT</span></span>
<span id="cb35-10"><a href="#cb35-10" aria-hidden="true" tabindex="-1"></a><span class="op">});</span></span></code></pre></div>
<p>The second way guarantees that <code>commit</code> or
<code>rollback</code> will be called. You can use either way.</p>
<p>Transactions are useful with <code>changes</code> sqlite function
that returns number of rows modified.</p>
<div class="sourceCode" id="cb36"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>storage<span class="op">.</span>transaction<span class="op">([&amp;]</span> <span class="op">()</span> <span class="at">mutable</span> <span class="op">{</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>    storage<span class="op">.</span>remove_all<span class="op">&lt;</span>User<span class="op">&gt;(</span>where<span class="op">(</span>c<span class="op">(&amp;</span>User<span class="op">::</span>id<span class="op">)</span> <span class="op">&lt;</span> <span class="dv">100</span><span class="op">));</span></span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">auto</span> usersRemoved <span class="op">=</span> storage<span class="op">.</span>changes<span class="op">();</span></span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>    cout <span class="op">&lt;&lt;</span> <span class="st">&quot;usersRemoved = &quot;</span> <span class="op">&lt;&lt;</span> usersRemoved <span class="op">&lt;&lt;</span> endl<span class="op">;</span></span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="kw">true</span><span class="op">;</span></span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a><span class="op">});</span></span></code></pre></div>
<p>It will print a number of deleted users (rows). But if you call
<code>changes</code> without a transaction and your database is located
in file not in RAM the result will be 0 always cause
<code>sqlite_orm</code> opens and closes connection every time you call
a function without a transaction.</p>
<p>Also a <code>transaction</code> function returns <code>true</code> if
transaction is commited and <code>false</code> if it is rollbacked. It
can be useful if your next actions depend on transaction result:</p>
<div class="sourceCode" id="cb37"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="kw">auto</span> commited <span class="op">=</span> storage<span class="op">.</span>transaction<span class="op">([&amp;]</span> <span class="op">()</span> <span class="at">mutable</span> <span class="op">{</span>    </span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>    <span class="kw">auto</span> secondUser <span class="op">=</span> storage<span class="op">.</span>get<span class="op">&lt;</span>User<span class="op">&gt;(</span><span class="dv">2</span><span class="op">);</span></span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>    secondUser<span class="op">.</span>typeId <span class="op">=</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a>    storage<span class="op">.</span>update<span class="op">(</span>secondUser<span class="op">);</span></span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a>    <span class="kw">auto</span> gottaRollback <span class="op">=</span> <span class="dt">bool</span><span class="op">(</span>rand<span class="op">()</span> <span class="op">%</span> <span class="dv">2</span><span class="op">);</span></span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span><span class="op">(</span>gottaRollback<span class="op">){</span>  <span class="co">//  dummy condition for test</span></span>
<span id="cb37-7"><a href="#cb37-7" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="kw">false</span><span class="op">;</span>   <span class="co">//  exits lambda and calls ROLLBACK</span></span>
<span id="cb37-8"><a href="#cb37-8" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb37-9"><a href="#cb37-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="kw">true</span><span class="op">;</span>        <span class="co">//  exits lambda and calls COMMIT</span></span>
<span id="cb37-10"><a href="#cb37-10" aria-hidden="true" tabindex="-1"></a><span class="op">});</span></span>
<span id="cb37-11"><a href="#cb37-11" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span><span class="op">(</span>commited<span class="op">){</span></span>
<span id="cb37-12"><a href="#cb37-12" aria-hidden="true" tabindex="-1"></a>    cout <span class="op">&lt;&lt;</span> <span class="st">&quot;Commited successfully, go on.&quot;</span> <span class="op">&lt;&lt;</span> endl<span class="op">;</span></span>
<span id="cb37-13"><a href="#cb37-13" aria-hidden="true" tabindex="-1"></a><span class="op">}</span><span class="cf">else</span><span class="op">{</span></span>
<span id="cb37-14"><a href="#cb37-14" aria-hidden="true" tabindex="-1"></a>    cerr <span class="op">&lt;&lt;</span> <span class="st">&quot;Commit failed, process an error&quot;</span> <span class="op">&lt;&lt;</span> endl<span class="op">;</span></span>
<span id="cb37-15"><a href="#cb37-15" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<p>Example for <code>transaction_guard</code> function:</p>
<div class="sourceCode" id="cb38"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="cf">try</span><span class="op">{</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>  <span class="kw">auto</span> guard <span class="op">=</span> storage<span class="op">.</span>transaction_guard<span class="op">();</span> <span class="co">//  calls </span><span class="re">BEGIN</span><span class="co"> TRANSACTION and returns guard object</span></span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>  user<span class="op">.</span>name <span class="op">=</span> <span class="st">&quot;Paul&quot;</span><span class="op">;</span></span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a>  <span class="kw">auto</span> notExisting <span class="op">=</span> storage<span class="op">.</span>get<span class="op">&lt;</span>User<span class="op">&gt;(-</span><span class="dv">1</span><span class="op">);</span> <span class="co">//  exception is thrown here, guard calls ROLLBACK in its destructor</span></span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a>  guard<span class="op">.</span>commit<span class="op">();</span></span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a><span class="op">}</span><span class="cf">catch</span><span class="op">(...){</span></span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a>  cerr <span class="op">&lt;&lt;</span> <span class="st">&quot;exception&quot;</span> <span class="op">&lt;&lt;</span> endl<span class="op">;</span></span>
<span id="cb38-8"><a href="#cb38-8" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<h1 id="in-memory-database">In memory database</h1>
<p>To manage in memory database just provide <code>:memory:</code> or
<code>""</code> instead as filename to <code>make_storage</code>.</p>
<h1 id="comparison-with-other-c-libs">Comparison with other C++
libs</h1>
<table style="width:100%;">
<colgroup>
<col style="width: 13%" />
<col style="width: 21%" />
<col style="width: 21%" />
<col style="width: 21%" />
<col style="width: 21%" />
</colgroup>
<thead>
<tr class="header">
<th></th>
<th style="text-align: center;">sqlite_orm</th>
<th style="text-align: center;"><a
href="https://github.com/SRombauts/SQLiteCpp">SQLiteCpp</a></th>
<th style="text-align: center;"><a
href="https://github.com/paulftw/hiberlite">hiberlite</a></th>
<th style="text-align: center;"><a
href="https://www.codesynthesis.com/products/odb/">ODB</a></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Schema sync</td>
<td style="text-align: center;">yes</td>
<td style="text-align: center;">no</td>
<td style="text-align: center;">yes</td>
<td style="text-align: center;">no</td>
</tr>
<tr class="even">
<td>Single responsibility principle</td>
<td style="text-align: center;">yes</td>
<td style="text-align: center;">yes</td>
<td style="text-align: center;">no</td>
<td style="text-align: center;">no</td>
</tr>
<tr class="odd">
<td>STL compatible</td>
<td style="text-align: center;">yes</td>
<td style="text-align: center;">no</td>
<td style="text-align: center;">no</td>
<td style="text-align: center;">no</td>
</tr>
<tr class="even">
<td>No raw string queries</td>
<td style="text-align: center;">yes</td>
<td style="text-align: center;">no</td>
<td style="text-align: center;">yes</td>
<td style="text-align: center;">yes</td>
</tr>
<tr class="odd">
<td>Transactions</td>
<td style="text-align: center;">yes</td>
<td style="text-align: center;">yes</td>
<td style="text-align: center;">no</td>
<td style="text-align: center;">yes</td>
</tr>
<tr class="even">
<td>Custom types binding</td>
<td style="text-align: center;">yes</td>
<td style="text-align: center;">no</td>
<td style="text-align: center;">yes</td>
<td style="text-align: center;">yes</td>
</tr>
<tr class="odd">
<td>Doesn’t use macros and/or external codegen scripts</td>
<td style="text-align: center;">yes</td>
<td style="text-align: center;">yes</td>
<td style="text-align: center;">no</td>
<td style="text-align: center;">no</td>
</tr>
<tr class="even">
<td>Aggregate functions</td>
<td style="text-align: center;">yes</td>
<td style="text-align: center;">yes</td>
<td style="text-align: center;">no</td>
<td style="text-align: center;">yes</td>
</tr>
<tr class="odd">
<td>Prepared statements</td>
<td style="text-align: center;">yes</td>
<td style="text-align: center;">yes</td>
<td style="text-align: center;">no</td>
<td style="text-align: center;">no</td>
</tr>
</tbody>
</table>
<h1 id="notes">Notes</h1>
<p>To work well your data model class must be default constructable and
must not have const fields mapped to database cause they are assigned
during queries. Otherwise code won’t compile on line with member
assignment operator.</p>
<p>For more details please check the project <a
href="https://github.com/fnc12/sqlite_orm/wiki">wiki</a>.</p>
<h1 id="installation">Installation</h1>
<p><strong>Note</strong>: Installation is not necessary if you plan to
use the fetchContent method, see below in Usage.</p>
<p>Use a popular package manager like <a
href="https://github.com/Microsoft/vcpkg">vcpkg</a> and just install it
with the <code>vcpkg install sqlite-orm</code> command.</p>
<p>Or you build it from source:</p>
<div class="sourceCode" id="cb39"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="fu">git</span> clone https://github.com/fnc12/sqlite_orm.git sqlite_orm</span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a><span class="bu">cd</span> sqlite_orm</span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a><span class="fu">cmake</span> <span class="at">-B</span> build</span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a><span class="fu">cmake</span> <span class="at">--build</span> build <span class="at">--target</span> install</span></code></pre></div>
<p>You might need admin rights for the last command.</p>
<h1 id="usage">Usage</h1>
<h2 id="cmake">CMake</h2>
<p>If you use cmake, there are two supported ways how to use it with
cmake (if another works as well or should be supported, open an
issue).</p>
<p>Either way you choose, the include path as well as the dependency
sqlite3 will be set automatically on your target. So usage is straight
forward, but you need to have installed sqlite3 on your system (see
Requirements below)</p>
<h2 id="find-package">Find Package</h2>
<p>If you have installed the lib system wide and it’s in your PATH, you
can use find_package to include it in cmake. It will make a target
<code>sqlite_orm::sqlite_orm</code> available which you can link
against. Have a look at examples/find_package for a full example.</p>
<div class="sourceCode" id="cb40"><pre
class="sourceCode cmake"><code class="sourceCode cmake"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="kw">find_package</span>(SqliteOrm <span class="ot">REQUIRED</span>)</span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a><span class="kw">target_link_libraries</span>(<span class="bn">main</span> <span class="ot">PRIVATE</span> <span class="bn">sqlite_orm::sqlite_orm</span>)</span></code></pre></div>
<h2 id="fetch-content-recommended">Fetch Content (Recommended)</h2>
<p>Alternatively, cmake can download the project directly from github
during configure stage and therefore you don’t need to install the lib
before. Againt a target <code>sqlite_orm::sqlite_orm</code> will be
available which you can link against. Have a look at
examples/fetch_content for a full example.</p>
<h2 id="no-cmake">No CMake</h2>
<p>If you want to use the lib directly with Make or something else, just
set the inlcude path correctly (should be correct on Linux already), so
<code>sqlite_orm/sqlite_orm.h</code> is found. As this is a header only
lib, there is nothing more you have to do.</p>
<h1 id="requirements">Requirements</h1>
<ul>
<li>C++14 compatible compiler (not C++11 cause of templated lambdas in
the lib).</li>
<li>Sqlite3 installed on your system and in the path, so cmake can find
it (or linked to you project if you don’t use cmake)</li>
</ul>
<h1 id="video-from-conference">Video from conference</h1>
<p><a href="https://www.youtube.com/watch?v=ngsilquWgpo"><img
src="https://img.youtube.com/vi/ngsilquWgpo/0.jpg"
alt="Video from conference" /></a></p>
<h1 id="sqliteman">SqliteMan</h1>
<p>In case you need a native SQLite client for macOS or Windows 10 you
can use SqliteMan https://sqliteman.dev. It is not a commercial. It is a
free native client being developed by the maintainer of this repo.</p>
